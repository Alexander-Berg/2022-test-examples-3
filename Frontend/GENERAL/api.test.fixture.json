{
    "build": {
      "jobs": {
        "47oNNgQ": {
          "name": "Setup",
          "title": "Setup task",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace cache -s ./sources -d $OVERLAYFS_MOUNTDIR -p ./patch-install -w ./work -c $HEAD_COMMIT --cmd \"npx frontend-ci install-root && trendbox output installed \"true\"\nnpx frontend-ci calc-selective-checks --since $BASE_COMMIT | xargs trendbox output changed_packages\"\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping script"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "output": [
            {
              "name": "changed_packages",
              "value": null
            },
            {
              "name": "installed",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "4ZAihBZ": {
          "name": "Bootstrap",
          "title": "Bootstrap task",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace cache -s ./sources -d $OVERLAYFS_MOUNTDIR -p ./patch-bootstrap -w ./work  -c $HEAD_COMMIT --cmd \"npx frontend-ci bootstrap --since=$BASE_COMMIT --concurrency=8\" && trendbox output bootstrapped \"true\"\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 7200000,
          "priority": "high",
          "output": [
            {
              "name": "bootstrapped",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "jmX2wP3": {
          "name": "Update PR description",
          "title": "Update PR description",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-pr-update.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "tWzP5Ei": {
          "name": "Publish",
          "title": "Publish",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "DRY_RUN": "1"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'Skip. Emulating after merge env'"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'Skip. Emulating after merge env'"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'Skip. Emulating after merge env'"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=${TRENDBOX_PULL_REQUEST_NUMBER:-undefined}\n# fetch-rebase: https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/merge-queue-utils/lib/merge-queue-utils.js#L166-L193\n# local-merge: https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/merge-queue-utils/lib/merge-queue-utils.js#L207-L234\n# exec after_merge scripts\necho '###' merge-package-locks\necho 'Skip running script: packages/frontend-ci/legacy/merge-queue/fetch-package-locks.js'\necho '###' release-packages\npackages/frontend-ci/legacy/merge-queue/release-packages.js\n# push: https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/merge-queue-utils/lib/merge-queue-utils.js#L236-L242\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "2UM4fsQ": {
          "name": "Hermione",
          "title": "Hermione",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n[ -d $USE_ARC ] && git lfs pull\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 4
            },
            "selenium_rtc_linux": {
              "weight": 15
            },
            "selenium_android": {
              "weight": 10
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "parallelism": {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE.length",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages"
            ]
          },
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "x15Xj9w": {
          "name": "Hermione",
          "title": "Hermione large",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n[ -d $USE_ARC ] && git lfs pull\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 8
            },
            "selenium_rtc_linux": {
              "weight": 30
            },
            "selenium_android": {
              "weight": 20
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_FATTY",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "parallelism": {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_FATTY.length",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages"
            ]
          },
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "7mKkH73": {
          "name": "Unit",
          "title": "Unit",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:unit --leaf $TRENDBOX_INPUT_SCOPES"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_UNIT.join(\" \")",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "onSNJbu": {
          "name": "Hermione e2e",
          "title": "Hermione e2e",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "NPM_TASK": "ci:e2e",
                "json_reporter_enabled": "true",
                "html_reporter_save_format": "sqlite"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_rtc_linux": {
              "weight": 5
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "HbZz454": {
          "name": "PulseStatic",
          "title": "PulseStatic",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:static --leaf $TRENDBOX_INPUT_SCOPES"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_PULSE_STATIC.join(\" \")",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "2L9YmkV": {
          "name": "PulseShooter/Desktop",
          "title": "PulseShooter/Desktop",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "desktop"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "39nXJP4": {
          "name": "PulseShooter/Touch",
          "title": "PulseShooter/Touch",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "touch"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "fEj13or": {
          "name": "Publish list of changed packages",
          "title": "Publish list of changed packages",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=$(npx frontend-ci config pr-number)\nnpx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -w ./work -p ./patch -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci publish-package-locks --prNumber $PR_NUMBER\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-changed-list.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "2qnDYBh": {
          "name": "Linters",
          "title": "Linters",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT -f patch-install\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/tools/run-lint.sh $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "N3muNtm": {
          "name": "ExpFlags: upload",
          "title": "ExpFlags: upload",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT -f patch-install\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci expflags-sync --action upload --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "4EkF19n": {
          "name": "Testpalm: validate",
          "title": "Testpalm: validate",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:validate --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "3rn31tg": {
          "name": "Deploy",
          "title": "Deploy",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\n#        frontend.ci.deploy\nexport PATH=\"$PATH:$PWD/node_modules/@yandex-int/frontend.ci.deploy/node_modules/.bin\"\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy --since $BASE_COMMIT",
                  "trendbox output deployed \"true\""
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "output": [
            {
              "name": "deployed",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "BGfgDAD": {
          "name": "Check templates",
          "title": "Check templates",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "YENV": "production"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci check-templates --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "XmVRX9u": {
          "name": "PR: Create AB Experiment",
          "title": "   0%  ",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=$(npx frontend-ci config pr-number)\n#   \nnpx frontend-ci pr-experiment --since $BASE_COMMIT --prNumber $PR_NUMBER\n#        (  )\npackages/frontend-ci/legacy/trendbox/run-pr-update.js 'selective-experiment' '.config/pr-description-experiment-config.js'\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 1800000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        },
        "2GA3prj": {
          "name": "Drone",
          "title": "Drone",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "drone_projects": "{services,packages}/*",
                "drone_config_filename": ".drone.yml",
                "drone_version": "0.5.0-yandex.15"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "base_commit=$BASE_COMMIT packages/frontend-ci/legacy/trendbox/run-drone.sh"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build"
          }
        }
      },
      "jobConditions": {
        "2UM4fsQ": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "x15Xj9w": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_FATTY && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "7mKkH73": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_UNIT && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "onSNJbu": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_E2E && jobs.Bootstrap.output.bootstrapped && jobs.Deploy.output.deployed",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped",
              "jobs.Deploy.output.deployed"
            ]
          }
        ],
        "HbZz454": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_PULSE_STATIC && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "2L9YmkV": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_PULSE_SHOOTER && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "39nXJP4": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_PULSE_SHOOTER && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "fEj13or": [
          {
            "rawValue": "jobs.Setup.output.installed",
            "contextRequirements": [
              "jobs.Setup.output.installed"
            ]
          }
        ],
        "2qnDYBh": [
          {
            "rawValue": "jobs.Setup.output.installed",
            "contextRequirements": [
              "jobs.Setup.output.installed"
            ]
          }
        ],
        "N3muNtm": [
          {
            "rawValue": "jobs.Setup.output.installed",
            "contextRequirements": [
              "jobs.Setup.output.installed"
            ]
          }
        ],
        "4EkF19n": [
          {
            "rawValue": "jobs.Setup.output.installed && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.installed",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "3rn31tg": [
          {
            "rawValue": "jobs.Setup.output.installed && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.installed",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "BGfgDAD": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_CHECK_TEMPLATES && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "XmVRX9u": [
          {
            "rawValue": "jobs.Deploy.output.deployed",
            "contextRequirements": [
              "jobs.Deploy.output.deployed"
            ]
          }
        ],
        "2GA3prj": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_DRONE",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages"
            ]
          }
        ]
      },
      "jobDependencies": {
        "2UM4fsQ": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "x15Xj9w": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "7mKkH73": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "HbZz454": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "onSNJbu": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "3rn31tg",
              "jobName": "Deploy"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "deployed"
              }
            }
          }
        ],
        "2L9YmkV": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "39nXJP4": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "fEj13or": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "installed"
              }
            }
          }
        ],
        "2qnDYBh": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "installed"
              }
            }
          }
        ],
        "N3muNtm": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "installed"
              }
            }
          }
        ],
        "4EkF19n": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "installed"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "3rn31tg": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "installed"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "BGfgDAD": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4ZAihBZ",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "XmVRX9u": [
          {
            "dependency": {
              "jobHash": "3rn31tg",
              "jobName": "Deploy"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "deployed"
              }
            }
          }
        ],
        "2GA3prj": [
          {
            "dependency": {
              "jobHash": "47oNNgQ",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          }
        ]
      },
      "jobOverrides": {}
    },
    "build_master": {
      "jobs": {
        "4RuBupo": {
          "name": "publish_node_modules_cache",
          "title": "Publish node_modules",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)",
                  "npx frontend-ci install-root --ignore-cache --publish-node-modules-cache"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping script"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "type": "SSD",
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "r1mNsd1": {
          "name": "Testpalm: synchronize",
          "title": "Testpalm: synchronize",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)\nnpx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --lfs --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:synchronize --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "2C9XhLM": {
          "name": "ExpFlags: convert to testids",
          "title": "ExpFlags: convert to testids",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)\nnpx frontend-ci expflags-to-testids --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "49KRmA7": {
          "name": "Hermione: master",
          "title": "Hermione: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --publishNpmCache --lfs --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 16
            },
            "selenium_rtc_linux": {
              "weight": 62
            },
            "selenium_android": {
              "weight": 40
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "4ThfYaQ": {
          "name": "Deploy: master",
          "title": "Deploy: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy:master --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "2GA3prj": {
          "name": "Drone",
          "title": "Drone",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "drone_projects": "{services,packages}/*",
                "drone_config_filename": ".drone.yml",
                "drone_version": "0.5.0-yandex.15"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "base_commit=$BASE_COMMIT packages/frontend-ci/legacy/trendbox/run-drone.sh"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "pR293dd": {
          "name": "ExpFlags: update",
          "title": "ExpFlags: update",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci expflags-sync --action update --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "pMXX6rQ": {
          "name": "PulseShooter/Desktop: master",
          "title": "PulseShooter/Desktop: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "desktop"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci bootstrap --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        },
        "vt7tx1M": {
          "name": "PulseShooter/Touch: master",
          "title": "PulseShooter/Touch: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "touch"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci bootstrap --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_master"
          }
        }
      },
      "jobDependencies": {
        "2C9XhLM": [
          {
            "id": "r1mNsd1",
            "query": {
              "name": "Testpalm: synchronize"
            },
            "dependant": {
              "id": "2C9XhLM",
              "name": "ExpFlags: convert to testids"
            }
          },
          {
            "id": "pR293dd",
            "query": {
              "name": "ExpFlags: update"
            },
            "dependant": {
              "id": "2C9XhLM",
              "name": "ExpFlags: convert to testids"
            }
          }
        ]
      },
      "jobConditions": {},
      "jobOverrides": {}
    },
    "build_release": {
      "jobs": {
        "2hGwBev": {
          "name": "Unit: release",
          "title": "Unit: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:unit --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "3Eg9TCD": {
          "name": "Hermione: release",
          "title": "Hermione: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE --lfs\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 16
            },
            "selenium_rtc_linux": {
              "weight": 62
            },
            "selenium_android": {
              "weight": 40
            }
          },
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "3UVDMq4": {
          "name": "Hermione e2e: release",
          "title": "Hermione e2e: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "NPM_TASK": "ci:e2e",
                "json_reporter_enabled": "true",
                "html_reporter_save_format": "sqlite",
                "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE --lfs\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_rtc_linux": {
              "weight": 5
            }
          },
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "G1gBE2Z": {
          "name": "Deploy: release",
          "title": "Deploy: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-deploy.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "9ZK2Nin": {
          "name": "Testpalm: suite",
          "title": "Testpalm: suite",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:suite --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "29QYm3M": {
          "name": "Drone: release",
          "title": "Drone: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "drone_projects": "{services,packages}/*",
                "drone_config_filename": ".drone.yml",
                "drone_version": "0.5.0-yandex.15"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "SERVICE=`sed 's/.*\\/\\(.*\\)\\/.*/\\1/' <<< $TRENDBOX_BRANCH`\nDIRS=( {services,packages}/$SERVICE )\n\nuse_dirs=$DIRS packages/frontend-ci/legacy/trendbox/run-drone.sh\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "type": "SSD",
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "2rWQYQP": {
          "name": "PulseStatic: release",
          "title": "PulseStatic: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:static --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "QtvZAz6": {
          "name": "PulseShooter/Desktop: release",
          "title": "PulseShooter/Desktop: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "desktop"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        },
        "4Tbe9DW": {
          "name": "PulseShooter/Touch: release",
          "title": "PulseShooter/Touch: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "touch"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "build_release"
          }
        }
      },
      "jobDependencies": {
        "3UVDMq4": [
          {
            "id": "G1gBE2Z",
            "query": {
              "name": "Deploy: release"
            },
            "dependant": {
              "id": "3UVDMq4",
              "name": "Hermione e2e: release"
            }
          }
        ],
        "9ZK2Nin": [
          {
            "id": "G1gBE2Z",
            "query": {
              "name": "Deploy: release"
            },
            "dependant": {
              "id": "9ZK2Nin",
              "name": "Testpalm: suite"
            }
          }
        ]
      },
      "jobConditions": {},
      "jobOverrides": {}
    },
    "mq": {
      "jobs": {
        "2c8ppvV": {
          "name": "Setup",
          "title": "Setup task",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace cache -s ./sources -d $OVERLAYFS_MOUNTDIR -p ./patch-install -w ./work -c $HEAD_COMMIT --cmd \"npx frontend-ci install-root --ignore-cache && trendbox output installed \"true\"\nnpx frontend-ci calc-selective-checks --since $BASE_COMMIT | xargs trendbox output changed_packages\"\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping script"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "output": [
            {
              "name": "changed_packages",
              "value": null
            },
            {
              "name": "installed",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        },
        "4NFNT3H": {
          "name": "Bootstrap",
          "title": "Bootstrap task",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root --ignore-cache"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace cache -s ./sources -d $OVERLAYFS_MOUNTDIR -p ./patch-bootstrap -w ./work  -c $HEAD_COMMIT --cmd \"npx frontend-ci bootstrap --since=$BASE_COMMIT --concurrency=8\" && trendbox output bootstrapped \"true\"\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 7200000,
          "priority": "high",
          "output": [
            {
              "name": "bootstrapped",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        },
        "2UM4fsQ": {
          "name": "Hermione",
          "title": "Hermione",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n[ -d $USE_ARC ] && git lfs pull\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 4
            },
            "selenium_rtc_linux": {
              "weight": 15
            },
            "selenium_android": {
              "weight": 10
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "parallelism": {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE.length",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages"
            ]
          },
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        },
        "x15Xj9w": {
          "name": "Hermione",
          "title": "Hermione large",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n[ -d $USE_ARC ] && git lfs pull\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 8
            },
            "selenium_rtc_linux": {
              "weight": 30
            },
            "selenium_android": {
              "weight": 20
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_FATTY",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "parallelism": {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_FATTY.length",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages"
            ]
          },
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        },
        "4EkF19n": {
          "name": "Testpalm: validate",
          "title": "Testpalm: validate",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:validate --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        },
        "2qnDYBh": {
          "name": "Linters",
          "title": "Linters",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT -f patch-install\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/tools/run-lint.sh $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        },
        "7mKkH73": {
          "name": "Unit",
          "title": "Unit",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:unit --leaf $TRENDBOX_INPUT_SCOPES"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": {
                "rawValue": "jobs.Setup.output.changed_packages.NEED_UNIT.join(\" \")",
                "contextRequirements": [
                  "jobs.Setup.output.changed_packages"
                ]
              }
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "mq"
          }
        }
      },
      "jobConditions": {
        "2UM4fsQ": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "x15Xj9w": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_HERMIONE_FATTY && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "4EkF19n": [
          {
            "rawValue": "jobs.Setup.resolution === \"success\" && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.resolution",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ],
        "2qnDYBh": [
          {
            "rawValue": "jobs.Setup.resolution === \"success\"",
            "contextRequirements": [
              "jobs.Setup.resolution"
            ]
          }
        ],
        "7mKkH73": [
          {
            "rawValue": "jobs.Setup.output.changed_packages.NEED_UNIT && jobs.Bootstrap.output.bootstrapped",
            "contextRequirements": [
              "jobs.Setup.output.changed_packages",
              "jobs.Bootstrap.output.bootstrapped"
            ]
          }
        ]
      },
      "jobDependencies": {
        "2UM4fsQ": [
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4NFNT3H",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "x15Xj9w": [
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4NFNT3H",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "7mKkH73": [
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "changed_packages"
              }
            }
          },
          {
            "dependency": {
              "jobHash": "4NFNT3H",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "4EkF19n": [
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobResolution",
            "ref": {
              "resolution": ""
            }
          },
          {
            "dependency": {
              "jobHash": "4NFNT3H",
              "jobName": "Bootstrap"
            },
            "type": "JobOutput",
            "ref": {
              "output": {
                "name": "bootstrapped"
              }
            }
          }
        ],
        "2qnDYBh": [
          {
            "dependency": {
              "jobHash": "2c8ppvV",
              "jobName": "Setup"
            },
            "type": "JobResolution",
            "ref": {
              "resolution": ""
            }
          }
        ]
      },
      "jobOverrides": {}
    },
    "after_merge_pr": {
      "jobs": {
        "34yCzuA": {
          "name": "Enable skipped tests",
          "title": "Enable skipped tests",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=$(npx frontend-ci config pr-number)\nBRANCH_NAME=$(npx frontend-ci config base-branch-name)\nnpx frontend-ci enable-skipped-tests --prNumber $PR_NUMBER --branchName $BRANCH_NAME --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "after_merge_pr"
          }
        },
        "2X7x5ji": {
          "name": "Delete deployed beta",
          "title": "Delete deployed beta",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy:remove --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "after_merge_pr"
          }
        }
      },
      "jobConditions": {},
      "jobDependencies": {},
      "jobOverrides": {}
    },
    "after_decline_pr": {
      "jobs": {
        "2X7x5ji": {
          "name": "Delete deployed beta",
          "title": "Delete deployed beta",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy:remove --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "after_decline_pr"
          }
        }
      },
      "jobConditions": {},
      "jobDependencies": {},
      "jobOverrides": {}
    },
    "DEFAULT_WORKFLOW": {
      "jobs": {
        "3rn31tg": {
          "name": "Deploy",
          "title": "Deploy",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\n#        frontend.ci.deploy\nexport PATH=\"$PATH:$PWD/node_modules/@yandex-int/frontend.ci.deploy/node_modules/.bin\"\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy --since $BASE_COMMIT",
                  "trendbox output deployed \"true\""
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "output": [
            {
              "name": "deployed",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2X7x5ji": {
          "name": "Delete deployed beta",
          "title": "Delete deployed beta",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy:remove --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "4ThfYaQ": {
          "name": "Deploy: master",
          "title": "Deploy: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:deploy:master --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "G1gBE2Z": {
          "name": "Deploy: release",
          "title": "Deploy: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-deploy.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "29QYm3M": {
          "name": "Drone: release",
          "title": "Drone: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "drone_projects": "{services,packages}/*",
                "drone_config_filename": ".drone.yml",
                "drone_version": "0.5.0-yandex.15"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "SERVICE=`sed 's/.*\\/\\(.*\\)\\/.*/\\1/' <<< $TRENDBOX_BRANCH`\nDIRS=( {services,packages}/$SERVICE )\n\nuse_dirs=$DIRS packages/frontend-ci/legacy/trendbox/run-drone.sh\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "type": "SSD",
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2GA3prj": {
          "name": "Drone",
          "title": "Drone",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "drone_projects": "{services,packages}/*",
                "drone_config_filename": ".drone.yml",
                "drone_version": "0.5.0-yandex.15"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "base_commit=$BASE_COMMIT packages/frontend-ci/legacy/trendbox/run-drone.sh"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "drone_projects": "{services,packages}/*",
                    "drone_config_filename": ".drone.yml",
                    "drone_version": "0.5.0-yandex.15"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2qnDYBh": {
          "name": "Linters",
          "title": "Linters",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT -f patch-install\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/tools/run-lint.sh $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "46Xv65P": {
          "name": "Unit",
          "title": "Unit",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:unit --leaf $TRENDBOX_INPUT_SCOPES"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2hGwBev": {
          "name": "Unit: release",
          "title": "Unit: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:unit --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "MOCHA_OPTS": "--reporter=spec --reporter-options output=__reports/report-unit.txt"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "4EkF19n": {
          "name": "Testpalm: validate",
          "title": "Testpalm: validate",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:validate --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,serp:*,palmsync:converter:*,testpalm*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "r1mNsd1": {
          "name": "Testpalm: synchronize",
          "title": "Testpalm: synchronize",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)\nnpx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --lfs --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:synchronize --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "hermione*,si:ci:*,testpalm*,serp:*,palmsync:converter:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "9ZK2Nin": {
          "name": "Testpalm: suite",
          "title": "Testpalm: suite",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:testpalm:suite --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "onSNJbu": {
          "name": "Hermione e2e",
          "title": "Hermione e2e",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "NPM_TASK": "ci:e2e",
                "json_reporter_enabled": "true",
                "html_reporter_save_format": "sqlite"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_rtc_linux": {
              "weight": 5
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "3UVDMq4": {
          "name": "Hermione e2e: release",
          "title": "Hermione e2e: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "NPM_TASK": "ci:e2e",
                "json_reporter_enabled": "true",
                "html_reporter_save_format": "sqlite",
                "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE --lfs\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "NPM_TASK": "ci:e2e",
                    "json_reporter_enabled": "true",
                    "html_reporter_save_format": "sqlite",
                    "RELEASE_SERVICE": "$(npx frontend-ci config release-service)"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_rtc_linux": {
              "weight": 5
            }
          },
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "3Wzx7qr": {
          "name": "Hermione",
          "title": "Hermione",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n[ -d $USE_ARC ] && git lfs pull\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 16
            },
            "selenium_rtc_linux": {
              "weight": 62
            },
            "selenium_android": {
              "weight": 40
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "49KRmA7": {
          "name": "Hermione: master",
          "title": "Hermione: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci bootstrap --since $BASE_COMMIT --publishNpmCache --lfs --concurrency 8\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 16
            },
            "selenium_rtc_linux": {
              "weight": 62
            },
            "selenium_android": {
              "weight": 40
            }
          },
          "timeout": 5400000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "3Eg9TCD": {
          "name": "Hermione: release",
          "title": "Hermione: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "LFS_CACHE": "True",
                "NPM_TASK": "ci:hermione",
                "json_reporter_enabled": "true",
                "hermione_usage_stats_enabled": "false",
                "html_reporter_save_format": "sqlite",
                "hermione_muted_tests_testcop_stats_enabled": "true",
                "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                "ARCHON_FORCE_EXIT_CODE": "0",
                "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE --lfs\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-job.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "LFS_CACHE": "True",
                    "NPM_TASK": "ci:hermione",
                    "json_reporter_enabled": "true",
                    "hermione_usage_stats_enabled": "false",
                    "html_reporter_save_format": "sqlite",
                    "hermione_muted_tests_testcop_stats_enabled": "true",
                    "ARCHON_DEACTIVATE_TIMEOUT": "20000",
                    "ARCHON_FORCE_EXIT_CODE": "0",
                    "ARCHON_IGNORE_DEACTIVATION_ERRORS": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {
            "selenium_edge": {
              "weight": 16
            },
            "selenium_rtc_linux": {
              "weight": 62
            },
            "selenium_android": {
              "weight": 40
            }
          },
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "fEj13or": {
          "name": "Publish list of changed packages",
          "title": "Publish list of changed packages",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=$(npx frontend-ci config pr-number)\nnpx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -w ./work -p ./patch -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\nnpx frontend-ci package-lock-gen --since $BASE_COMMIT\nnpx frontend-ci publish-package-locks --prNumber $PR_NUMBER\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-changed-list.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "jmX2wP3": {
          "name": "Update PR description",
          "title": "Update PR description",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "packages/frontend-ci/legacy/trendbox/run-pr-update.js"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "34yCzuA": {
          "name": "Enable skipped tests",
          "title": "Enable skipped tests",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=$(npx frontend-ci config pr-number)\nBRANCH_NAME=$(npx frontend-ci config base-branch-name)\nnpx frontend-ci enable-skipped-tests --prNumber $PR_NUMBER --branchName $BRANCH_NAME --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "4NdcMk2": {
          "name": "PulseStatic",
          "title": "PulseStatic",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:static --leaf $TRENDBOX_INPUT_SCOPES"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "input": [
            {
              "name": "scopes",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2rWQYQP": {
          "name": "PulseStatic: release",
          "title": "PulseStatic: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:static --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2L9YmkV": {
          "name": "PulseShooter/Desktop",
          "title": "PulseShooter/Desktop",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "desktop"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "QtvZAz6": {
          "name": "PulseShooter/Desktop: release",
          "title": "PulseShooter/Desktop: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "desktop"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "pMXX6rQ": {
          "name": "PulseShooter/Desktop: master",
          "title": "PulseShooter/Desktop: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "desktop"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci bootstrap --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "desktop"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "39nXJP4": {
          "name": "PulseShooter/Touch",
          "title": "PulseShooter/Touch",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "touch"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "4Tbe9DW": {
          "name": "PulseShooter/Touch: release",
          "title": "PulseShooter/Touch: release",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "touch"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "RELEASE_SERVICE=$(npx frontend-ci config release-service)\nnpx frontend-ci install-root\nnpx frontend-ci bootstrap --leaf $RELEASE_SERVICE\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --leaf $RELEASE_SERVICE"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "vt7tx1M": {
          "name": "PulseShooter/Touch: master",
          "title": "PulseShooter/Touch: master",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "true",
                "CI": "true",
                "PLATFORM": "touch"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root\nnpx frontend-ci bootstrap --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci ci:pulse:shooter --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "true",
                    "CI": "true",
                    "PLATFORM": "touch"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "tWzP5Ei": {
          "name": "Publish",
          "title": "Publish",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "DRY_RUN": "1"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'Skip. Emulating after merge env'"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'Skip. Emulating after merge env'"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'Skip. Emulating after merge env'"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=${TRENDBOX_PULL_REQUEST_NUMBER:-undefined}\n# fetch-rebase: https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/merge-queue-utils/lib/merge-queue-utils.js#L166-L193\n# local-merge: https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/merge-queue-utils/lib/merge-queue-utils.js#L207-L234\n# exec after_merge scripts\necho '###' merge-package-locks\necho 'Skip running script: packages/frontend-ci/legacy/merge-queue/fetch-package-locks.js'\necho '###' release-packages\npackages/frontend-ci/legacy/merge-queue/release-packages.js\n# push: https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/merge-queue-utils/lib/merge-queue-utils.js#L236-L242\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "DRY_RUN": "1"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "BGfgDAD": {
          "name": "Check templates",
          "title": "Check templates",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true",
                "YENV": "production"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci check-templates --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true",
                    "YENV": "production"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "N3muNtm": {
          "name": "ExpFlags: upload",
          "title": "ExpFlags: upload",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT -f patch-install\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci expflags-sync --action upload --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "pR293dd": {
          "name": "ExpFlags: update",
          "title": "ExpFlags: update",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci expflags-sync --action update --since $BASE_COMMIT"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "2C9XhLM": {
          "name": "ExpFlags: convert to testids",
          "title": "ExpFlags: convert to testids",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npm install"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)\nnpx frontend-ci expflags-to-testids --since $BASE_COMMIT\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "si:ci:*,testpalm*,serp:*,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "4RuBupo": {
          "name": "publish_node_modules_cache",
          "title": "Publish node_modules",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)",
                  "npx frontend-ci install-root --ignore-cache --publish-node-modules-cache"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping script"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "type": "SSD",
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 3600000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "XmVRX9u": {
          "name": "PR: Create AB Experiment",
          "title": "   0%  ",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace attach -s ./sources -d $OVERLAYFS_MOUNTDIR -c $HEAD_COMMIT\ncd $OVERLAYFS_MOUNTDIR_ABS\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "export PATH=\"${PWD}/merged/node_modules/.bin:${PATH}\"",
                  "export tunneler_user=robot-frontend",
                  "export tunneler_hosts='[\"tun.si.yandex-team.ru\"]'",
                  "export tunneler_version=2",
                  "export tunneler_cloud=yp",
                  "cat <<< \"$ROBOT_FRONTEND_SSH_KEY\" > id_rsa",
                  "chmod 400 id_rsa",
                  "ssh-add id_rsa"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "PR_NUMBER=$(npx frontend-ci config pr-number)\n#   \nnpx frontend-ci pr-experiment --since $BASE_COMMIT --prNumber $PR_NUMBER\n#        (  )\npackages/frontend-ci/legacy/trendbox/run-pr-update.js 'selective-experiment' '.config/pr-description-experiment-config.js'\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 1800000,
          "priority": "high",
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "47oNNgQ": {
          "name": "Setup",
          "title": "Setup task",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace cache -s ./sources -d $OVERLAYFS_MOUNTDIR -p ./patch-install -w ./work -c $HEAD_COMMIT --cmd \"npx frontend-ci install-root && trendbox output installed \"true\"\nnpx frontend-ci calc-selective-checks --since $BASE_COMMIT | xargs trendbox output changed_packages\"\n"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping script"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 8
            },
            "ram": 17179869184,
            "disk": {
              "space": 42949672960
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 5400000,
          "priority": "high",
          "output": [
            {
              "name": "changed_packages",
              "value": null
            },
            {
              "name": "installed",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        },
        "4ZAihBZ": {
          "name": "Bootstrap",
          "title": "Bootstrap task",
          "lifecycle": {
            "id": 1,
            "name": "root",
            "type": "meta-step",
            "flow": "trendbox:typical",
            "options": {
              "env": {
                "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                "node_js_version": "12.14.1",
                "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                "SANDBOX_PRIVILEGED_CONTAINER": "1",
                "CI": "true"
              },
              "shell": {
                "command": "/usr/bin/env bash -o pipefail"
              }
            },
            "steps": [
              {
                "id": 2,
                "name": "prepare",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo 'env variables: '; node -p 'Object.entries(process.env).map(([k,v])=>`${k}=${/(pass|secret|ssh|token|auth)/i.test(k)?`(${v.length} bytes)`:JSON.stringify(v)}`).join(`\n`)'",
                  "export NVM_DIR=\"/opt/nvm\"",
                  "export npm_config_registry=http://npm.yandex-team.ru/",
                  "export npm_config_user_agent=\"npm/6.14.5 (verdaccio yandex canary)\"",
                  "export npm_config_audit=false",
                  "export npm_config_prefer_offline=true",
                  "export npm_config_nodedir=\"${NVM_DIR}/versions/node/v${node_js_version}\"",
                  "export npm_config_ensure=true",
                  "nvm use $node_js_version",
                  "export SANDBOX_OAUTH_TOKEN=\"$SANDBOX_AUTH_TOKEN\"",
                  "export GRPC_DNS_RESOLVER=native",
                  "export FRONTEND_ARC_SOURCE=$(node -p '`${JSON.parse(process.env.checkout_config).mount_path}/${JSON.parse(process.env.checkout_config).path}`')",
                  "export USE_ARC=\"$(cd $FRONTEND_ARC_SOURCE && arc rev-parse --is-inside-work-tree 2> /dev/null)\"",
                  "[ -z $USE_ARC ] && export OVERLAYFS_MOUNTDIR_ABS=$(pwd)/merged || export OVERLAYFS_MOUNTDIR_ABS=$FRONTEND_ARC_SOURCE; export OVERLAYFS_MOUNTDIR=$(python -c \"import os.path; print os.path.relpath('$OVERLAYFS_MOUNTDIR_ABS', '$(pwd)')\");",
                  "[ -z $USE_ARC ] && CACHE_DIR=git-cache; [ -z $USE_ARC ] && LFS_ATTRIBUTE=${LFS_CACHE:-False}; [ -z $USE_ARC ] && sandbox find-resource --limit 1 --state READY --owner FRONTEND --type SANDBOX_CI_GIT_CACHE --attr-lfs ${LFS_ATTRIBUTE} --attr-git_url git@github.yandex-team.ru:search-interfaces/frontend.git | sandbox download-resources --dest-dir ${CACHE_DIR}; [ -z $USE_ARC ] && [ -d ${CACHE_DIR} ] && mkdir -p sources/.git && tar -xf git-cache/cache.tar -C sources/.git || echo \"Cache not found\"",
                  "trendbox checkout -c $checkout_config --dir sources",
                  "cd sources",
                  "hash -r"
                ]
              },
              {
                "id": 3,
                "name": "before_install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "cd ./packages/frontend.ci.utils && npm link --unsafe-perm && cd -",
                  "cd ./packages/frontend-ci && npm link --unsafe-perm && npm link @yandex-int/frontend.ci.utils --unsafe-perm && cd -",
                  "HEAD_COMMIT=$(npx frontend-ci config head-commit)",
                  "BASE_COMMIT=$(npx frontend-ci config base-commit)"
                ]
              },
              {
                "id": 4,
                "name": "install",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci install-root"
                ]
              },
              {
                "id": 5,
                "name": "before_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "echo skipping before_script"
                ]
              },
              {
                "id": 6,
                "name": "script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": [
                  "npx frontend-ci workspace cache -s ./sources -d $OVERLAYFS_MOUNTDIR -p ./patch-bootstrap -w ./work  -c $HEAD_COMMIT --cmd \"npx frontend-ci bootstrap --since=$BASE_COMMIT --concurrency=8\" && trendbox output bootstrapped \"true\"\n"
                ]
              },
              {
                "id": 7,
                "name": "after_success",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 8,
                "name": "after_failure",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 9,
                "name": "before_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 10,
                "name": "deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 11,
                "name": "after_deploy",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              },
              {
                "id": 12,
                "name": "after_script",
                "type": "step",
                "options": {
                  "env": {
                    "NODE_EXTRA_CA_CERTS": "/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt",
                    "node_js_version": "12.14.1",
                    "DEBUG": "serp:*,templar:timers,si:archon:*,si:why-is-archon-running,kurwahl*,diffalka*",
                    "SANDBOX_PRIVILEGED_CONTAINER": "1",
                    "CI": "true"
                  },
                  "shell": {
                    "command": "/usr/bin/env bash -o pipefail"
                  }
                },
                "commands": []
              }
            ]
          },
          "container": {
            "type": "LXC",
            "storage": {
              "type": "sandbox-resource",
              "host": "sandbox.yandex-team.ru",
              "options": {
                "id": "1580581629"
              }
            }
          },
          "agent": {
            "cpu": {
              "cores": 32
            },
            "ram": 68719476736,
            "disk": {
              "space": 64424509440
            },
            "os": {
              "name": "LINUX",
              "distribution": "UBUNTU"
            }
          },
          "captureSemaphores": {},
          "timeout": 7200000,
          "priority": "high",
          "output": [
            {
              "name": "bootstrapped",
              "value": null
            }
          ],
          "cloud": {
            "type": "sandbox",
            "options": {
              "host": "sandbox.yandex-team.ru",
              "owner": "FRONTEND"
            }
          },
          "format": "0.2",
          "workcopies": {},
          "workflow": {
            "name": "DEFAULT_WORKFLOW"
          }
        }
      },
      "jobConditions": {},
      "jobDependencies": {},
      "jobOverrides": {}
    }
}
