select straight_join distinct c.statusmoderate, co.statuspostmoderate, count(*) cnt, sum(if(b.statusmoderate = ? or p.statusmoderate = ?, ?, ?)) cnt_new, sum(if(b.statusmoderate in (...) or p.statusmoderate in (...) or b.phoneflag in (...), ?, ?)) cnt_mod, sum(if(b.statusmoderate = ? and (ifnull(b.href, ?) != ? or b.phoneflag = ? or t.statusmoderate = ? or b.banner_type in (...) or (b.banner_type in (...) and c.type = ?) or bp.permalink > ?) and p.statusmoderate = ? and coalesce(i.statusmoderate, b_perf.statusmoderate, ?) = ?, ?, ?)) cnt_accept, sum(if(b.statusmoderate = ? and (ifnull(b.href, ?) = ? and b.phoneflag = ?) and p.statusmoderate = ?, ?, ?)) cnt_wait, sum(if(b.statusmoderate = ? or p.statusmoderate = ? or coalesce(i.statusmoderate, b_perf.statusmoderate, ?) = ? or (ifnull(b.href, ?) = ? and b.phoneflag = ?) or (ifnull(b.href, ?) = ? and t.statusmoderate = ?), ?, ?)) cnt_decline, sum(if((b.statusmoderate = ? or b.statuspostmoderate = ?) and coalesce(i.statusmoderate, b_perf.statusmoderate, ?) = ? and (p.statusmoderate = ? or p.statuspostmoderate = ?) and (b.href is not null or b.phoneflag = ? or t.statusmoderate = ? or b.banner_type in (...)), ?, ?)) cnt_preliminarily, sum(if(p.statusmoderate = ?, ?, ?)) as group_cnt_accepted, c.agencyuid, c.manageruid, c.orderid, c.sum, c.sum_to_pay, c.uid, c.wallet_cid, c.type, c.cid from campaigns c left join camp_options co using(cid) join phrases p on p.cid = c.cid join banners b on p.pid = b.pid left join images i on b.bid = i.bid left join banners_performance b_perf on (b.banner_type = ? or b.banner_type = ?) and b_perf.bid = b.bid left join banner_turbolandings t on (b.cid = t.cid and b.bid = t.bid) left join banner_permalinks bp on bp.bid = b.bid and bp.permalink_assign_type = ? where c.cid = ? and c.clientid % ? >= ? group by c.statusmoderate