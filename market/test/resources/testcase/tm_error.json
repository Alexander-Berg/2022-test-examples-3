{
    "backend_tag": "production",
    "clickhouse_copy_options": {
        "command": "append",
        "date_column": "toYYYYMM(datetime)"
    },
    "clickhouse_copy_tool_settings_patch": {
        "clickhouse_client": {
            "per_shard_quorum": "at_least_one",
            "retriable_errors": [
                999,
                473
            ]
        },
        "preprocessing": {
            "yt_pool": "production-mstat-olap2-etl-default-tm"
        },
        "shard_uploader": {
            "job_executor": {
                "yt": {
                    "cluster_name": "hahn",
                    "pool": "production-mstat-olap2-etl-default-tm"
                }
            },
            "threads_per_host": 1
        }
    },
    "creation_time": "2020-11-03T09:39:13.854255Z",
    "destination_cluster": "mdb-clickhouse",
    "destination_table": "cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413",
    "error": {
        "attributes": {
            "details": "Traceback (most recent call last):\n  File \"transfer_manager/server/lib/task_executor_main.py\", line 189, in execute_task\n    task.clickhouse_copy_tool_settings_patch)\n  File \"transfer_manager/server/lib/remote_copy_tools.py\", line 692, in copy_yt_to_mdb_clickhouse\n    tool_settings_patch\n  File \"transfer_manager/server/lib/remote_copy_tools.py\", line 647, in copy_yt_to_clickhouse\n    settings_patch=tool_settings_patch\n  File \"transfer_manager/server/lib/clickhouse.py\", line 261, in copy_table\n    self._execute(copy_command, environment)\n  File \"transfer_manager/server/lib/clickhouse.py\", line 245, in _execute\n    raise ClickHouseCopyToolError(command, return_code, log)\nClickHouseCopyToolError: Copy tool command '/place/db/iss3/instances/27570_yt_transfer_manager_tXFsriRVbSQ/copy_table_yt_to_clickhouse append --yt-cluster hahn.yt.yandex.net --yt-table //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10 --ch-cluster MDB:mstat-cubes-ssd --ch-table cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413 --ch-seed-host sas-2lpe9dyapqjgo5sw.db.yandex.net --ch-seed-host sas-4mf6lg9tx63xvbxx.db.yandex.net --ch-seed-host sas-6uaospyk6tfc194x.db.yandex.net --ch-seed-host sas-6uoydvkvb4mxj170.db.yandex.net --ch-seed-host sas-7swchytkkyudn4aj.db.yandex.net --ch-seed-host sas-9o5f1k182otn52j4.db.yandex.net --ch-seed-host sas-9z7nq93dz88f1pho.db.yandex.net --ch-seed-host sas-azj2hs81egwhj69h.db.yandex.net --ch-seed-host sas-cod524sauqza8bby.db.yandex.net --ch-seed-host sas-gyriiyb7srqlf1pt.db.yandex.net --ch-seed-host sas-h7ktahwgq544p3o4.db.yandex.net --ch-seed-host sas-hpjgwxuctsnxqtfu.db.yandex.net --ch-seed-host sas-ht2az1s8oguv935j.db.yandex.net --ch-seed-host sas-itm372750t2ek38j.db.yandex.net --ch-seed-host sas-j71aguqe2pbtovrk.db.yandex.net --ch-seed-host sas-jwp1onzkyl41ixex.db.yandex.net --ch-seed-host sas-l01n0dgam1rz5hl9.db.yandex.net --ch-seed-host sas-m9s00o9xpzxtn6j9.db.yandex.net --ch-seed-host sas-mru0evis4ry067gy.db.yandex.net --ch-seed-host sas-mytr92dax16dcok2.db.yandex.net --ch-seed-host sas-mz2nqotqabkzx6am.db.yandex.net --ch-seed-host sas-p7ho4puhfhqmzd3b.db.yandex.net --ch-seed-host sas-pjfd7kx8f1b8p2z8.db.yandex.net --ch-seed-host sas-ptiwuyovbd07396g.db.yandex.net --ch-seed-host sas-qe6ccu58diplp53r.db.yandex.net --ch-seed-host sas-r5yuydxqpuba8ysc.db.yandex.net --ch-seed-host sas-r7cpbgj6a900umgw.db.yandex.net --ch-seed-host sas-rnrsxzwa4mnyk3fw.db.yandex.net --ch-seed-host sas-vi5o8dxykpogitlo.db.yandex.net --ch-seed-host sas-xkhz00getthvkxhz.db.yandex.net --ch-seed-host vla-02m8f0dqoju644i0.db.yandex.net --ch-seed-host vla-04x3o51vgfu96x8w.db.yandex.net --ch-seed-host vla-13e5um2q2pkuq18i.db.yandex.net --ch-seed-host vla-2w1jkz9f5xeg0os6.db.yandex.net --ch-seed-host vla-6dkutjeme2g1z3rg.db.yandex.net --ch-seed-host vla-74y256y8c4x3emnh.db.yandex.net --ch-seed-host vla-9896isc40158oan5.db.yandex.net --ch-seed-host vla-aemlr2ak76bob90f.db.yandex.net --ch-seed-host vla-c6xs4kbdg7bhjrve.db.yandex.net --ch-seed-host vla-cpt48s3th7q64hth.db.yandex.net --ch-seed-host vla-dym6zpbh06y8jvg3.db.yandex.net --ch-seed-host vla-fx55efz7jhl8350y.db.yandex.net --ch-seed-host vla-g3prkd4nurv18rb1.db.yandex.net --ch-seed-host vla-gi40aoy0s1yyeu4u.db.yandex.net --ch-seed-host vla-hbpsokbznvxev614.db.yandex.net --ch-seed-host vla-jr0gs65tkwqt8760.db.yandex.net --ch-seed-host vla-mnwns773zj7p7f7d.db.yandex.net --ch-seed-host vla-oaocqus17e5idopx.db.yandex.net --ch-seed-host vla-q8eovca63ejngb8u.db.yandex.net --ch-seed-host vla-rob5enh6riqhdros.db.yandex.net --ch-seed-host vla-s54ies7elge462vo.db.yandex.net --ch-seed-host vla-t44ck1a2z0yhd5pz.db.yandex.net --ch-seed-host vla-u786pyaxsj95c8qx.db.yandex.net --ch-seed-host vla-ubn3jnhd3beqmigz.db.yandex.net --ch-seed-host vla-ukx1tmet3v8al0xw.db.yandex.net --ch-seed-host vla-vhrapj2c0fsae9tg.db.yandex.net --ch-seed-host vla-wu9y7ek7f0uw1h5n.db.yandex.net --ch-seed-host vla-ygl8mgbtyain7wlh.db.yandex.net --ch-seed-host vla-yo8crwmlmhgp4kp3.db.yandex.net --ch-seed-host vla-yzh1ob4vn1fdmowe.db.yandex.net --ch-http-port 8443 --settings {\"clickhouse_client\": {\"per_shard_quorum\": \"at_least_one\", \"retriable_errors\": [999, 473], \"use_cluster_ddl\": true, \"cluster_command_timeouts\": {\"discover_table\": 30, \"ping_hosts\": 30, \"discover_cluster\": 30, \"create_table\": 90}}, \"clickhouse_tables\": {\"macros\": {\"replica\": \"replica\", \"shard\": \"shard\"}, \"zookeeper_base_path\": \"/clickhouse/tables\"}, \"preprocessing\": {\"preprocessed_data_replication_factor\": 3, \"enable_job_splitting\": false, \"partitions_per_shard\": 3, \"block_format\": \"RowBinary\", \"yt_pool\": \"production-mstat-olap2-etl-default-tm\", \"block_compression_level\": 3, \"data_size_per_job\": 1073741824, \"desired_block_size\": 100000000, \"desired_compressed_block_size\": 30000000, \"shuffle_shards\": false}, \"yt_task_state\": {\"remove_on_completion\": true, \"account\": null, \"tasks_base_path\": \"//tmp/copy_yt_to_clickhouse\", \"ttl\": 86400}, \"shard_uploader\": {\"lock_shard_timeout\": 60, \"too_many_parts_pause\": 10, \"ping_session_freq\": 2, \"insert_block_timeout\": 60, \"commit_batch_size\": 30, \"threads_per_host\": 1, \"job_executor\": {\"type\": \"yt\", \"yt\": {\"cluster_name\": \"vanga.yt.yandex.net\", \"job_memory_limit\": 8294967296, \"stderr_yt_path\": \"//tmp\", \"pool\": null, \"scheduling_tag_filter\": \"sas\"}}}} --ch-user cubes_etl_user --ch-https --date-column toYYYYMM(datetime)' exited with code 1: '2020-11-03 12:39:19,759 [INFO] -- copy_table.py -- creating yt client, cluster name = hahn.yt.yandex.net\\n2020-11-03 12:39:20,213 [INFO] -- copy_table.py -- hello, robot-mkt-olap2!\\n2020-11-03 12:39:20,462 [INFO] -- task_state.py -- tasks path: //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2\\n2020-11-03 12:39:20,524 [INFO] -- create.py -- creating clickhouse client, cluster name = MDB:mstat-cubes-ssd\\n2020-11-03 12:39:20,524 [INFO] -- command_discover_cluster.py -- discover cluster \\'MDB:mstat-cubes-ssd\\': seed hosts = [\\'sas-2lpe9dyapqjgo5sw.db.yandex.net\\', \\'sas-4mf6lg9tx63xvbxx.db.yandex.net\\', \\'sas-6uaospyk6tfc194x.db.yandex.net\\', \\'sas-6uoydvkvb4mxj170.db.yandex.net\\', \\'sas-7swchytkkyudn4aj.db.yandex.net\\', \\'sas-9o5f1k182otn52j4.db.yandex.net\\', \\'sas-9z7nq93dz88f1pho.db.yandex.net\\', \\'sas-azj2hs81egwhj69h.db.yandex.net\\', \\'sas-cod524sauqza8bby.db.yandex.net\\', \\'sas-gyriiyb7srqlf1pt.db.yandex.net\\', \\'sas-h7ktahwgq544p3o4.db.yandex.net\\', \\'sas-hpjgwxuctsnxqtfu.db.yandex.net\\', \\'sas-ht2az1s8oguv935j.db.yandex.net\\', \\'sas-itm372750t2ek38j.db.yandex.net\\', \\'sas-j71aguqe2pbtovrk.db.yandex.net\\', \\'sas-jwp1onzkyl41ixex.db.yandex.net\\', \\'sas-l01n0dgam1rz5hl9.db.yandex.net\\', \\'sas-m9s00o9xpzxtn6j9.db.yandex.net\\', \\'sas-mru0evis4ry067gy.db.yandex.net\\', \\'sas-mytr92dax16dcok2.db.yandex.net\\', \\'sas-mz2nqotqabkzx6am.db.yandex.net\\', \\'sas-p7ho4puhfhqmzd3b.db.yandex.net\\', \\'sas-pjfd7kx8f1b8p2z8.db.yandex.net\\', \\'sas-ptiwuyovbd07396g.db.yandex.net\\', \\'sas-qe6ccu58diplp53r.db.yandex.net\\', \\'sas-r5yuydxqpuba8ysc.db.yandex.net\\', \\'sas-r7cpbgj6a900umgw.db.yandex.net\\', \\'sas-rnrsxzwa4mnyk3fw.db.yandex.net\\', \\'sas-vi5o8dxykpogitlo.db.yandex.net\\', \\'sas-xkhz00getthvkxhz.db.yandex.net\\', \\'vla-02m8f0dqoju644i0.db.yandex.net\\', \\'vla-04x3o51vgfu96x8w.db.yandex.net\\', \\'vla-13e5um2q2pkuq18i.db.yandex.net\\', \\'vla-2w1jkz9f5xeg0os6.db.yandex.net\\', \\'vla-6dkutjeme2g1z3rg.db.yandex.net\\', \\'vla-74y256y8c4x3emnh.db.yandex.net\\', \\'vla-9896isc40158oan5.db.yandex.net\\', \\'vla-aemlr2ak76bob90f.db.yandex.net\\', \\'vla-c6xs4kbdg7bhjrve.db.yandex.net\\', \\'vla-cpt48s3th7q64hth.db.yandex.net\\', \\'vla-dym6zpbh06y8jvg3.db.yandex.net\\', \\'vla-fx55efz7jhl8350y.db.yandex.net\\', \\'vla-g3prkd4nurv18rb1.db.yandex.net\\', \\'vla-gi40aoy0s1yyeu4u.db.yandex.net\\', \\'vla-hbpsokbznvxev614.db.yandex.net\\', \\'vla-jr0gs65tkwqt8760.db.yandex.net\\', \\'vla-mnwns773zj7p7f7d.db.yandex.net\\', \\'vla-oaocqus17e5idopx.db.yandex.net\\', \\'vla-q8eovca63ejngb8u.db.yandex.net\\', \\'vla-rob5enh6riqhdros.db.yandex.net\\', \\'vla-s54ies7elge462vo.db.yandex.net\\', \\'vla-t44ck1a2z0yhd5pz.db.yandex.net\\', \\'vla-u786pyaxsj95c8qx.db.yandex.net\\', \\'vla-ubn3jnhd3beqmigz.db.yandex.net\\', \\'vla-ukx1tmet3v8al0xw.db.yandex.net\\', \\'vla-vhrapj2c0fsae9tg.db.yandex.net\\', \\'vla-wu9y7ek7f0uw1h5n.db.yandex.net\\', \\'vla-ygl8mgbtyain7wlh.db.yandex.net\\', \\'vla-yo8crwmlmhgp4kp3.db.yandex.net\\', \\'vla-yzh1ob4vn1fdmowe.db.yandex.net\\'], http port = 8443, credentials = (user = \\'cubes_etl_user\\', password = \\'w****************5\\')\\n2020-11-03 12:39:21,107 [INFO] -- command_discover_cluster.py -- cluster \\'MDB:mstat-cubes-ssd\\' discovered: <copy_yt_to_ch.cluster_client.cluster.Cluster object at 0x7f38a0357c10>\\n2020-11-03 12:39:21,222 [INFO] -- create.py -- destination cluster \\'MDB:mstat-cubes-ssd\\': 60 node(s), 30 shard(s)\\n2020-11-03 12:39:21,222 [INFO] -- create.py -- checking availability of destination cluster...\\n2020-11-03 12:39:21,879 [INFO] -- copy_table.py -- running brand new task\\n2020-11-03 12:39:28,243 [INFO] -- discover_dest_table.py -- destination table exists: cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413 (`channel` Nullable(String), `control_crypta_visitors_numeric` Nullable(Decimal(15,8)), `control_delivered_aov_numeric` Nullable(Decimal(15,8)), `control_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_opc_numeric` Nullable(Decimal(15,8)), `control_gross_aov_numeric` Nullable(Decimal(15,8)), `control_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_opc_numeric` Nullable(Decimal(15,8)), `control_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `control_rel_ue_numeric` Nullable(Decimal(15,8)), `control_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_sessions_numeric` Nullable(Decimal(15,8)), `control_spu_numeric` Nullable(Decimal(15,8)), `control_ue_numeric` Nullable(Decimal(15,8)), `control_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_visitors_numeric` Nullable(Decimal(15,8)), `control_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `datetime` DateTime, `incremental_crypta_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_nmv_ue_exchange_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_sessions_mw95_numeric` Nullable(Decimal(15,8)), `incremental_spu_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `p_value_crypta_visitors_numeric` Nullable(Decimal(15,8)), `p_value_delivered_aov_numeric` Nullable(Decimal(15,8)), `p_value_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_opc_numeric` Nullable(Decimal(15,8)), `p_value_gross_aov_numeric` Nullable(Decimal(15,8)), `p_value_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_opc_numeric` Nullable(Decimal(15,8)), `p_value_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_sessions_numeric` Nullable(Decimal(15,8)), `p_value_spu_numeric` Nullable(Decimal(15,8)), `p_value_ue_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_visitors_numeric` Nullable(Decimal(15,8)), `p_value_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `report_month` Nullable(String), `sending_type` Nullable(String), `splice_correction_numeric` Nullable(Decimal(15,8)), `target_crypta_visitors` Nullable(Int64), `target_delivered_aov_numeric` Nullable(Decimal(15,8)), `target_delivered_crypta_customers` Nullable(Int64), `target_delivered_customers` Nullable(Int64), `target_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_multiorders` Nullable(Int64), `target_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_opc_numeric` Nullable(Decimal(15,8)), `target_gross_aov_numeric` Nullable(Decimal(15,8)), `target_gross_crypta_customers` Nullable(Int64), `target_gross_customers` Nullable(Int64), `target_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_multiorders` Nullable(Int64), `target_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_opc_numeric` Nullable(Decimal(15,8)), `target_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `target_rel_ue_numeric` Nullable(Decimal(15,8)), `target_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_scale_numeric` Nullable(Decimal(15,8)), `target_sessions` Nullable(Int64), `target_spu_numeric` Nullable(Decimal(15,8)), `target_ue_numeric` Nullable(Decimal(15,8)), `target_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_visitors` Nullable(Int64), `target_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `total_control_crm_segment` Nullable(Int64), `total_target_crm_segment` Nullable(Int64)) engine = ReplicatedMergeTree(\\'/marketstat/cubes/ch/tables/{shard}/olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413\\', \\'{replica}\\') PARTITION BY toYYYYMM(datetime) ORDER BY tuple() SETTINGS index_granularity = 8192\\n2020-11-03 12:39:28,555 [INFO] -- task_state.py -- create task yt directory: //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2/MDB:mstat-cubes-ssd.cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413\\n2020-11-03 12:39:30,281 [INFO] -- prepare_rules_and_params.py -- prepare to copy clickhouse source table: infer schema, key columns, etc...\\n2020-11-03 12:39:30,326 [INFO] -- prepare_rules_and_params.py -- inferred table parameters: schema = (`channel` Nullable(String), `control_crypta_visitors_numeric` Nullable(Decimal(15,8)), `control_delivered_aov_numeric` Nullable(Decimal(15,8)), `control_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_opc_numeric` Nullable(Decimal(15,8)), `control_gross_aov_numeric` Nullable(Decimal(15,8)), `control_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_opc_numeric` Nullable(Decimal(15,8)), `control_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `control_rel_ue_numeric` Nullable(Decimal(15,8)), `control_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_sessions_numeric` Nullable(Decimal(15,8)), `control_spu_numeric` Nullable(Decimal(15,8)), `control_ue_numeric` Nullable(Decimal(15,8)), `control_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_visitors_numeric` Nullable(Decimal(15,8)), `control_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `datetime` DateTime, `incremental_crypta_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_nmv_ue_exchange_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_sessions_mw95_numeric` Nullable(Decimal(15,8)), `incremental_spu_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `p_value_crypta_visitors_numeric` Nullable(Decimal(15,8)), `p_value_delivered_aov_numeric` Nullable(Decimal(15,8)), `p_value_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_opc_numeric` Nullable(Decimal(15,8)), `p_value_gross_aov_numeric` Nullable(Decimal(15,8)), `p_value_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_opc_numeric` Nullable(Decimal(15,8)), `p_value_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_sessions_numeric` Nullable(Decimal(15,8)), `p_value_spu_numeric` Nullable(Decimal(15,8)), `p_value_ue_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_visitors_numeric` Nullable(Decimal(15,8)), `p_value_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `report_month` Nullable(String), `sending_type` Nullable(String), `splice_correction_numeric` Nullable(Decimal(15,8)), `target_crypta_visitors` Nullable(Int64), `target_delivered_aov_numeric` Nullable(Decimal(15,8)), `target_delivered_crypta_customers` Nullable(Int64), `target_delivered_customers` Nullable(Int64), `target_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_multiorders` Nullable(Int64), `target_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_opc_numeric` Nullable(Decimal(15,8)), `target_gross_aov_numeric` Nullable(Decimal(15,8)), `target_gross_crypta_customers` Nullable(Int64), `target_gross_customers` Nullable(Int64), `target_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_multiorders` Nullable(Int64), `target_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_opc_numeric` Nullable(Decimal(15,8)), `target_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `target_rel_ue_numeric` Nullable(Decimal(15,8)), `target_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_scale_numeric` Nullable(Decimal(15,8)), `target_sessions` Nullable(Int64), `target_spu_numeric` Nullable(Decimal(15,8)), `target_ue_numeric` Nullable(Decimal(15,8)), `target_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_visitors` Nullable(Int64), `target_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `total_control_crm_segment` Nullable(Int64), `total_target_crm_segment` Nullable(Int64)), engine parameters: primary key = tuple(), partition key = toYYYYMM(datetime)\\n2020-11-03 12:39:57,572 [INFO] -- preprocess_source_table.py -- snaphot of source table //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10: revision = 566364455352106, row count = 4\\n2020-11-03 12:39:57,572 [INFO] -- preprocess_source_table.py -- run preprocessing map from //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10 to //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2/MDB:mstat-cubes-ssd.cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413/shards\\n2020-11-03 12:39:58,655\\tINFO\\tOperation started: http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details\\n2020-11-03 12:39:58,815 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 starting\\n2020-11-03 12:40:00,124 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 initializing\\n2020-11-03 12:40:02,998 ( 0 min)\\tUnrecognized spec: {\\'job_proxy_footprint\\': 200000000L, \\'auto_merge\\': {\\'table_reader\\': {\\'window_size\\': 100000000L}}}\\n2020-11-03 12:40:02,998 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 materializing\\n2020-11-03 12:40:19,454 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=0     aborted=0     lost=0     total=1    \\n2020-11-03 12:40:34,719 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=1     completed=0     pending=0     failed=1     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:11,461 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=1     completed=0     pending=0     failed=2     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:27,305 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=4     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:37,934 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=5     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:43,067 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 failed\\n2020-11-03 12:41:50,261\\tWARNING\\t***** Failed operation information:\\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed\\n    Failed jobs limit exceeded\\n        User job failed\\n            Process terminated by signal 6\\n    User job failed\\n        Process terminated by signal 6\\n\\n***** Details:\\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed    \\n    origin          man1-7351-man-yt-transfer-manager-27570.gencfg-c.yandex.net on 2020-11-03T09:41:50.258169Z    \\n    stderrs         [{\\'host\\': \\'sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\\', \\'stderr\\': \\'uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan...message truncated...    \\n    url             http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details    \\n    state           failed    \\n    id              9580751-5f74e786-3fe03e8-2942d544\\nFailed jobs limit exceeded    \\n    code            215    \\n    origin          sas4-5483-controller-agent-hahn.sas.yp-c.yandex.net on 2020-11-03T09:41:37.419756Z (pid 2, tid 515b4a7187a0fe39, fid fffe1740f5733cf5)    \\n    max_failed_job_count 5\\nUser job failed    \\n    code            1205\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\nUser job failed    \\n    code            1205    \\n    stderr          uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\n\\n2020-11-03 12:41:50,261\\tWARNING\\tOne of the failed jobs:\\nHost: sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\\nError:\\nUser job failed\\n    Process terminated by signal 6\\n\\n***** Details:\\nUser job failed    \\n    code            1205    \\n    stderr          uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\n\\nuncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStringException) util/string/cast.cpp:679: cannot parse float(nan)\"\\n    type -> yexception\\n/bin/bash: line 1:    31 Aborted                 (core dumped) ./yt_to_ch_preprocessor_job --settings settings.json --translation-rules translation_rules.json --sharding-params sharding_params.json\\n\\n\\nTraceback (most recent call last):\\n  File \"<string>\", line 4, in <module>\\n  File \"library/python/runtime/importer.pxi\", line 266, in __res.ResourceImporter.run_main\\n    self.load_module(entry_point, fix_name=\\'__main__\\')\\n  File \"library/python/runtime/importer.pxi\", line 237, in __res.ResourceImporter.load_module\\n    exec code in mod.__dict__\\n  File \"__main__.py\", line 8, in <module>\\n  File \"transfer_manager/copy_yt_to_clickhouse/python/tool/copy_table.py\", line 72, in copy_table\\n    settings=settings,\\n  File \"transfer_manager/copy_yt_to_clickhouse/python/copy_table/copy_table.py\", line 99, in copy_table_from_yt_to_clickhouse\\n    settings)\\n  File \"transfer_manager/copy_yt_to_clickhouse/python/copy_table/preprocess_source_table.py\", line 183, in preprocess_source_table\\n    operation.wait()\\n  File \"yt/python/yt/wrapper/operation_commands.py\", line 752, in wait\\n    process_operation_unsuccesful_finish_state(self, self.get_error(state=state))\\n  File \"yt/python/yt/wrapper/operation_commands.py\", line 588, in process_operation_unsuccesful_finish_state\\n    raise error\\nYtOperationFailedError: Operation 9580751-5f74e786-3fe03e8-2942d544 failed\\n    Failed jobs limit exceeded\\n        User job failed\\n            Process terminated by signal 6\\n    User job failed\\n        Process terminated by signal 6\\n\\n***** Details:\\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed    \\n    origin          man1-7351-man-yt-transfer-manager-27570.gencfg-c.yandex.net on 2020-11-03T09:41:50.258169Z    \\n    stderrs         [{\\'host\\': \\'sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\\', \\'stderr\\': \\'uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan...message truncated...    \\n    url             http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details    \\n    state           failed    \\n    id              9580751-5f74e786-3fe03e8-2942d544\\nFailed jobs limit exceeded    \\n    code            215    \\n    origin          sas4-5483-controller-agent-hahn.sas.yp-c.yandex.net on 2020-11-03T09:41:37.419756Z (pid 2, tid 515b4a7187a0fe39, fid fffe1740f5733cf5)    \\n    max_failed_job_count 5\\nUser job failed    \\n    code            1205\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\nUser job failed    \\n    code            1205    \\n    stderr          uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\n'\n"
        },
        "code": 1,
        "message": "Copy tool command '/place/db/iss3/instances/27570_yt_transfer_manager_tXFsriRVbSQ/copy_table_yt_to_clickhouse append --yt-cluster hahn.yt.yandex.net --yt-table //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10 --ch-cluster MDB:mstat-cubes-ssd --ch-table cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413 --ch-seed-host sas-2lpe9dyapqjgo5sw.db.yandex.net --ch-seed-host sas-4mf6lg9tx63xvbxx.db.yandex.net --ch-seed-host sas-6uaospyk6tfc194x.db.yandex.net --ch-seed-host sas-6uoydvkvb4mxj170.db.yandex.net --ch-seed-host sas-7swchytkkyudn4aj.db.yandex.net --ch-seed-host sas-9o5f1k182otn52j4.db.yandex.net --ch-seed-host sas-9z7nq93dz88f1pho.db.yandex.net --ch-seed-host sas-azj2hs81egwhj69h.db.yandex.net --ch-seed-host sas-cod524sauqza8bby.db.yandex.net --ch-seed-host sas-gyriiyb7srqlf1pt.db.yandex.net --ch-seed-host sas-h7ktahwgq544p3o4.db.yandex.net --ch-seed-host sas-hpjgwxuctsnxqtfu.db.yandex.net --ch-seed-host sas-ht2az1s8oguv935j.db.yandex.net --ch-seed-host sas-itm372750t2ek38j.db.yandex.net --ch-seed-host sas-j71aguqe2pbtovrk.db.yandex.net --ch-seed-host sas-jwp1onzkyl41ixex.db.yandex.net --ch-seed-host sas-l01n0dgam1rz5hl9.db.yandex.net --ch-seed-host sas-m9s00o9xpzxtn6j9.db.yandex.net --ch-seed-host sas-mru0evis4ry067gy.db.yandex.net --ch-seed-host sas-mytr92dax16dcok2.db.yandex.net --ch-seed-host sas-mz2nqotqabkzx6am.db.yandex.net --ch-seed-host sas-p7ho4puhfhqmzd3b.db.yandex.net --ch-seed-host sas-pjfd7kx8f1b8p2z8.db.yandex.net --ch-seed-host sas-ptiwuyovbd07396g.db.yandex.net --ch-seed-host sas-qe6ccu58diplp53r.db.yandex.net --ch-seed-host sas-r5yuydxqpuba8ysc.db.yandex.net --ch-seed-host sas-r7cpbgj6a900umgw.db.yandex.net --ch-seed-host sas-rnrsxzwa4mnyk3fw.db.yandex.net --ch-seed-host sas-vi5o8dxykpogitlo.db.yandex.net --ch-seed-host sas-xkhz00getthvkxhz.db.yandex.net --ch-seed-host vla-02m8f0dqoju644i0.db.yandex.net --ch-seed-host vla-04x3o51vgfu96x8w.db.yandex.net --ch-seed-host vla-13e5um2q2pkuq18i.db.yandex.net --ch-seed-host vla-2w1jkz9f5xeg0os6.db.yandex.net --ch-seed-host vla-6dkutjeme2g1z3rg.db.yandex.net --ch-seed-host vla-74y256y8c4x3emnh.db.yandex.net --ch-seed-host vla-9896isc40158oan5.db.yandex.net --ch-seed-host vla-aemlr2ak76bob90f.db.yandex.net --ch-seed-host vla-c6xs4kbdg7bhjrve.db.yandex.net --ch-seed-host vla-cpt48s3th7q64hth.db.yandex.net --ch-seed-host vla-dym6zpbh06y8jvg3.db.yandex.net --ch-seed-host vla-fx55efz7jhl8350y.db.yandex.net --ch-seed-host vla-g3prkd4nurv18rb1.db.yandex.net --ch-seed-host vla-gi40aoy0s1yyeu4u.db.yandex.net --ch-seed-host vla-hbpsokbznvxev614.db.yandex.net --ch-seed-host vla-jr0gs65tkwqt8760.db.yandex.net --ch-seed-host vla-mnwns773zj7p7f7d.db.yandex.net --ch-seed-host vla-oaocqus17e5idopx.db.yandex.net --ch-seed-host vla-q8eovca63ejngb8u.db.yandex.net --ch-seed-host vla-rob5enh6riqhdros.db.yandex.net --ch-seed-host vla-s54ies7elge462vo.db.yandex.net --ch-seed-host vla-t44ck1a2z0yhd5pz.db.yandex.net --ch-seed-host vla-u786pyaxsj95c8qx.db.yandex.net --ch-seed-host vla-ubn3jnhd3beqmigz.db.yandex.net --ch-seed-host vla-ukx1tmet3v8al0xw.db.yandex.net --ch-seed-host vla-vhrapj2c0fsae9tg.db.yandex.net --ch-seed-host vla-wu9y7ek7f0uw1h5n.db.yandex.net --ch-seed-host vla-ygl8mgbtyain7wlh.db.yandex.net --ch-seed-host vla-yo8crwmlmhgp4kp3.db.yandex.net --ch-seed-host vla-yzh1ob4vn1fdmowe.db.yandex.net --ch-http-port 8443 --settings {\"clickhouse_client\": {\"per_shard_quorum\": \"at_least_one\", \"retriable_errors\": [999, 473], \"use_cluster_ddl\": true, \"cluster_command_timeouts\": {\"discover_table\": 30, \"ping_hosts\": 30, \"discover_cluster\": 30, \"create_table\": 90}}, \"clickhouse_tables\": {\"macros\": {\"replica\": \"replica\", \"shard\": \"shard\"}, \"zookeeper_base_path\": \"/clickhouse/tables\"}, \"preprocessing\": {\"preprocessed_data_replication_factor\": 3, \"enable_job_splitting\": false, \"partitions_per_shard\": 3, \"block_format\": \"RowBinary\", \"yt_pool\": \"production-mstat-olap2-etl-default-tm\", \"block_compression_level\": 3, \"data_size_per_job\": 1073741824, \"desired_block_size\": 100000000, \"desired_compressed_block_size\": 30000000, \"shuffle_shards\": false}, \"yt_task_state\": {\"remove_on_completion\": true, \"account\": null, \"tasks_base_path\": \"//tmp/copy_yt_to_clickhouse\", \"ttl\": 86400}, \"shard_uploader\": {\"lock_shard_timeout\": 60, \"too_many_parts_pause\": 10, \"ping_session_freq\": 2, \"insert_block_timeout\": 60, \"commit_batch_size\": 30, \"threads_per_host\": 1, \"job_executor\": {\"type\": \"yt\", \"yt\": {\"cluster_name\": \"vanga.yt.yandex.net\", \"job_memory_limit\": 8294967296, \"stderr_yt_path\": \"//tmp\", \"pool\": null, \"scheduling_tag_filter\": \"sas\"}}}} --ch-user cubes_etl_user --ch-https --date-column toYYYYMM(datetime)' exited with code 1: '2020-11-03 12:39:19,759 [INFO] -- copy_table.py -- creating yt client, cluster name = hahn.yt.yandex.net\\n2020-11-03 12:39:20,213 [INFO] -- copy_table.py -- hello, robot-mkt-olap2!\\n2020-11-03 12:39:20,462 [INFO] -- task_state.py -- tasks path: //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2\\n2020-11-03 12:39:20,524 [INFO] -- create.py -- creating clickhouse client, cluster name = MDB:mstat-cubes-ssd\\n2020-11-03 12:39:20,524 [INFO] -- command_discover_cluster.py -- discover cluster \\'MDB:mstat-cubes-ssd\\': seed hosts = [\\'sas-2lpe9dyapqjgo5sw.db.yandex.net\\', \\'sas-4mf6lg9tx63xvbxx.db.yandex.net\\', \\'sas-6uaospyk6tfc194x.db.yandex.net\\', \\'sas-6uoydvkvb4mxj170.db.yandex.net\\', \\'sas-7swchytkkyudn4aj.db.yandex.net\\', \\'sas-9o5f1k182otn52j4.db.yandex.net\\', \\'sas-9z7nq93dz88f1pho.db.yandex.net\\', \\'sas-azj2hs81egwhj69h.db.yandex.net\\', \\'sas-cod524sauqza8bby.db.yandex.net\\', \\'sas-gyriiyb7srqlf1pt.db.yandex.net\\', \\'sas-h7ktahwgq544p3o4.db.yandex.net\\', \\'sas-hpjgwxuctsnxqtfu.db.yandex.net\\', \\'sas-ht2az1s8oguv935j.db.yandex.net\\', \\'sas-itm372750t2ek38j.db.yandex.net\\', \\'sas-j71aguqe2pbtovrk.db.yandex.net\\', \\'sas-jwp1onzkyl41ixex.db.yandex.net\\', \\'sas-l01n0dgam1rz5hl9.db.yandex.net\\', \\'sas-m9s00o9xpzxtn6j9.db.yandex.net\\', \\'sas-mru0evis4ry067gy.db.yandex.net\\', \\'sas-mytr92dax16dcok2.db.yandex.net\\', \\'sas-mz2nqotqabkzx6am.db.yandex.net\\', \\'sas-p7ho4puhfhqmzd3b.db.yandex.net\\', \\'sas-pjfd7kx8f1b8p2z8.db.yandex.net\\', \\'sas-ptiwuyovbd07396g.db.yandex.net\\', \\'sas-qe6ccu58diplp53r.db.yandex.net\\', \\'sas-r5yuydxqpuba8ysc.db.yandex.net\\', \\'sas-r7cpbgj6a900umgw.db.yandex.net\\', \\'sas-rnrsxzwa4mnyk3fw.db.yandex.net\\', \\'sas-vi5o8dxykpogitlo.db.yandex.net\\', \\'sas-xkhz00getthvkxhz.db.yandex.net\\', \\'vla-02m8f0dqoju644i0.db.yandex.net\\', \\'vla-04x3o51vgfu96x8w.db.yandex.net\\', \\'vla-13e5um2q2pkuq18i.db.yandex.net\\', \\'vla-2w1jkz9f5xeg0os6.db.yandex.net\\', \\'vla-6dkutjeme2g1z3rg.db.yandex.net\\', \\'vla-74y256y8c4x3emnh.db.yandex.net\\', \\'vla-9896isc40158oan5.db.yandex.net\\', \\'vla-aemlr2ak76bob90f.db.yandex.net\\', \\'vla-c6xs4kbdg7bhjrve.db.yandex.net\\', \\'vla-cpt48s3th7q64hth.db.yandex.net\\', \\'vla-dym6zpbh06y8jvg3.db.yandex.net\\', \\'vla-fx55efz7jhl8350y.db.yandex.net\\', \\'vla-g3prkd4nurv18rb1.db.yandex.net\\', \\'vla-gi40aoy0s1yyeu4u.db.yandex.net\\', \\'vla-hbpsokbznvxev614.db.yandex.net\\', \\'vla-jr0gs65tkwqt8760.db.yandex.net\\', \\'vla-mnwns773zj7p7f7d.db.yandex.net\\', \\'vla-oaocqus17e5idopx.db.yandex.net\\', \\'vla-q8eovca63ejngb8u.db.yandex.net\\', \\'vla-rob5enh6riqhdros.db.yandex.net\\', \\'vla-s54ies7elge462vo.db.yandex.net\\', \\'vla-t44ck1a2z0yhd5pz.db.yandex.net\\', \\'vla-u786pyaxsj95c8qx.db.yandex.net\\', \\'vla-ubn3jnhd3beqmigz.db.yandex.net\\', \\'vla-ukx1tmet3v8al0xw.db.yandex.net\\', \\'vla-vhrapj2c0fsae9tg.db.yandex.net\\', \\'vla-wu9y7ek7f0uw1h5n.db.yandex.net\\', \\'vla-ygl8mgbtyain7wlh.db.yandex.net\\', \\'vla-yo8crwmlmhgp4kp3.db.yandex.net\\', \\'vla-yzh1ob4vn1fdmowe.db.yandex.net\\'], http port = 8443, credentials = (user = \\'cubes_etl_user\\', password = \\'w****************5\\')\\n2020-11-03 12:39:21,107 [INFO] -- command_discover_cluster.py -- cluster \\'MDB:mstat-cubes-ssd\\' discovered: <copy_yt_to_ch.cluster_client.cluster.Cluster object at 0x7f38a0357c10>\\n2020-11-03 12:39:21,222 [INFO] -- create.py -- destination cluster \\'MDB:mstat-cubes-ssd\\': 60 node(s), 30 shard(s)\\n2020-11-03 12:39:21,222 [INFO] -- create.py -- checking availability of destination cluster...\\n2020-11-03 12:39:21,879 [INFO] -- copy_table.py -- running brand new task\\n2020-11-03 12:39:28,243 [INFO] -- discover_dest_table.py -- destination table exists: cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413 (`channel` Nullable(String), `control_crypta_visitors_numeric` Nullable(Decimal(15,8)), `control_delivered_aov_numeric` Nullable(Decimal(15,8)), `control_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_opc_numeric` Nullable(Decimal(15,8)), `control_gross_aov_numeric` Nullable(Decimal(15,8)), `control_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_opc_numeric` Nullable(Decimal(15,8)), `control_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `control_rel_ue_numeric` Nullable(Decimal(15,8)), `control_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_sessions_numeric` Nullable(Decimal(15,8)), `control_spu_numeric` Nullable(Decimal(15,8)), `control_ue_numeric` Nullable(Decimal(15,8)), `control_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_visitors_numeric` Nullable(Decimal(15,8)), `control_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `datetime` DateTime, `incremental_crypta_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_nmv_ue_exchange_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_sessions_mw95_numeric` Nullable(Decimal(15,8)), `incremental_spu_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `p_value_crypta_visitors_numeric` Nullable(Decimal(15,8)), `p_value_delivered_aov_numeric` Nullable(Decimal(15,8)), `p_value_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_opc_numeric` Nullable(Decimal(15,8)), `p_value_gross_aov_numeric` Nullable(Decimal(15,8)), `p_value_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_opc_numeric` Nullable(Decimal(15,8)), `p_value_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_sessions_numeric` Nullable(Decimal(15,8)), `p_value_spu_numeric` Nullable(Decimal(15,8)), `p_value_ue_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_visitors_numeric` Nullable(Decimal(15,8)), `p_value_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `report_month` Nullable(String), `sending_type` Nullable(String), `splice_correction_numeric` Nullable(Decimal(15,8)), `target_crypta_visitors` Nullable(Int64), `target_delivered_aov_numeric` Nullable(Decimal(15,8)), `target_delivered_crypta_customers` Nullable(Int64), `target_delivered_customers` Nullable(Int64), `target_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_multiorders` Nullable(Int64), `target_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_opc_numeric` Nullable(Decimal(15,8)), `target_gross_aov_numeric` Nullable(Decimal(15,8)), `target_gross_crypta_customers` Nullable(Int64), `target_gross_customers` Nullable(Int64), `target_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_multiorders` Nullable(Int64), `target_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_opc_numeric` Nullable(Decimal(15,8)), `target_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `target_rel_ue_numeric` Nullable(Decimal(15,8)), `target_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_scale_numeric` Nullable(Decimal(15,8)), `target_sessions` Nullable(Int64), `target_spu_numeric` Nullable(Decimal(15,8)), `target_ue_numeric` Nullable(Decimal(15,8)), `target_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_visitors` Nullable(Int64), `target_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `total_control_crm_segment` Nullable(Int64), `total_target_crm_segment` Nullable(Int64)) engine = ReplicatedMergeTree(\\'/marketstat/cubes/ch/tables/{shard}/olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413\\', \\'{replica}\\') PARTITION BY toYYYYMM(datetime) ORDER BY tuple() SETTINGS index_granularity = 8192\\n2020-11-03 12:39:28,555 [INFO] -- task_state.py -- create task yt directory: //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2/MDB:mstat-cubes-ssd.cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413\\n2020-11-03 12:39:30,281 [INFO] -- prepare_rules_and_params.py -- prepare to copy clickhouse source table: infer schema, key columns, etc...\\n2020-11-03 12:39:30,326 [INFO] -- prepare_rules_and_params.py -- inferred table parameters: schema = (`channel` Nullable(String), `control_crypta_visitors_numeric` Nullable(Decimal(15,8)), `control_delivered_aov_numeric` Nullable(Decimal(15,8)), `control_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_opc_numeric` Nullable(Decimal(15,8)), `control_gross_aov_numeric` Nullable(Decimal(15,8)), `control_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_opc_numeric` Nullable(Decimal(15,8)), `control_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `control_rel_ue_numeric` Nullable(Decimal(15,8)), `control_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_sessions_numeric` Nullable(Decimal(15,8)), `control_spu_numeric` Nullable(Decimal(15,8)), `control_ue_numeric` Nullable(Decimal(15,8)), `control_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_visitors_numeric` Nullable(Decimal(15,8)), `control_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `datetime` DateTime, `incremental_crypta_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_nmv_ue_exchange_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_sessions_mw95_numeric` Nullable(Decimal(15,8)), `incremental_spu_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `p_value_crypta_visitors_numeric` Nullable(Decimal(15,8)), `p_value_delivered_aov_numeric` Nullable(Decimal(15,8)), `p_value_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_opc_numeric` Nullable(Decimal(15,8)), `p_value_gross_aov_numeric` Nullable(Decimal(15,8)), `p_value_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_opc_numeric` Nullable(Decimal(15,8)), `p_value_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_sessions_numeric` Nullable(Decimal(15,8)), `p_value_spu_numeric` Nullable(Decimal(15,8)), `p_value_ue_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_visitors_numeric` Nullable(Decimal(15,8)), `p_value_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `report_month` Nullable(String), `sending_type` Nullable(String), `splice_correction_numeric` Nullable(Decimal(15,8)), `target_crypta_visitors` Nullable(Int64), `target_delivered_aov_numeric` Nullable(Decimal(15,8)), `target_delivered_crypta_customers` Nullable(Int64), `target_delivered_customers` Nullable(Int64), `target_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_multiorders` Nullable(Int64), `target_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_opc_numeric` Nullable(Decimal(15,8)), `target_gross_aov_numeric` Nullable(Decimal(15,8)), `target_gross_crypta_customers` Nullable(Int64), `target_gross_customers` Nullable(Int64), `target_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_multiorders` Nullable(Int64), `target_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_opc_numeric` Nullable(Decimal(15,8)), `target_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `target_rel_ue_numeric` Nullable(Decimal(15,8)), `target_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_scale_numeric` Nullable(Decimal(15,8)), `target_sessions` Nullable(Int64), `target_spu_numeric` Nullable(Decimal(15,8)), `target_ue_numeric` Nullable(Decimal(15,8)), `target_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_visitors` Nullable(Int64), `target_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `total_control_crm_segment` Nullable(Int64), `total_target_crm_segment` Nullable(Int64)), engine parameters: primary key = tuple(), partition key = toYYYYMM(datetime)\\n2020-11-03 12:39:57,572 [INFO] -- preprocess_source_table.py -- snaphot of source table //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10: revision = 566364455352106, row count = 4\\n2020-11-03 12:39:57,572 [INFO] -- preprocess_source_table.py -- run preprocessing map from //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10 to //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2/MDB:mstat-cubes-ssd.cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413/shards\\n2020-11-03 12:39:58,655\\tINFO\\tOperation started: http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details\\n2020-11-03 12:39:58,815 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 starting\\n2020-11-03 12:40:00,124 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 initializing\\n2020-11-03 12:40:02,998 ( 0 min)\\tUnrecognized spec: {\\'job_proxy_footprint\\': 200000000L, \\'auto_merge\\': {\\'table_reader\\': {\\'window_size\\': 100000000L}}}\\n2020-11-03 12:40:02,998 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 materializing\\n2020-11-03 12:40:19,454 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=0     aborted=0     lost=0     total=1    \\n2020-11-03 12:40:34,719 ( 0 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=1     completed=0     pending=0     failed=1     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:11,461 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=1     completed=0     pending=0     failed=2     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:27,305 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=4     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:37,934 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=5     aborted=0     lost=0     total=1    \\n2020-11-03 12:41:43,067 ( 1 min)\\toperation 9580751-5f74e786-3fe03e8-2942d544 failed\\n2020-11-03 12:41:50,261\\tWARNING\\t***** Failed operation information:\\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed\\n    Failed jobs limit exceeded\\n        User job failed\\n            Process terminated by signal 6\\n    User job failed\\n        Process terminated by signal 6\\n\\n***** Details:\\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed    \\n    origin          man1-7351-man-yt-transfer-manager-27570.gencfg-c.yandex.net on 2020-11-03T09:41:50.258169Z    \\n    stderrs         [{\\'host\\': \\'sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\\', \\'stderr\\': \\'uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan...message truncated...    \\n    url             http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details    \\n    state           failed    \\n    id              9580751-5f74e786-3fe03e8-2942d544\\nFailed jobs limit exceeded    \\n    code            215    \\n    origin          sas4-5483-controller-agent-hahn.sas.yp-c.yandex.net on 2020-11-03T09:41:37.419756Z (pid 2, tid 515b4a7187a0fe39, fid fffe1740f5733cf5)    \\n    max_failed_job_count 5\\nUser job failed    \\n    code            1205\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\nUser job failed    \\n    code            1205    \\n    stderr          uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\n\\n2020-11-03 12:41:50,261\\tWARNING\\tOne of the failed jobs:\\nHost: sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\\nError:\\nUser job failed\\n    Process terminated by signal 6\\n\\n***** Details:\\nUser job failed    \\n    code            1205    \\n    stderr          uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\n\\nuncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStringException) util/string/cast.cpp:679: cannot parse float(nan)\"\\n    type -> yexception\\n/bin/bash: line 1:    31 Aborted                 (core dumped) ./yt_to_ch_preprocessor_job --settings settings.json --translation-rules translation_rules.json --sharding-params sharding_params.json\\n\\n\\nTraceback (most recent call last):\\n  File \"<string>\", line 4, in <module>\\n  File \"library/python/runtime/importer.pxi\", line 266, in __res.ResourceImporter.run_main\\n    self.load_module(entry_point, fix_name=\\'__main__\\')\\n  File \"library/python/runtime/importer.pxi\", line 237, in __res.ResourceImporter.load_module\\n    exec code in mod.__dict__\\n  File \"__main__.py\", line 8, in <module>\\n  File \"transfer_manager/copy_yt_to_clickhouse/python/tool/copy_table.py\", line 72, in copy_table\\n    settings=settings,\\n  File \"transfer_manager/copy_yt_to_clickhouse/python/copy_table/copy_table.py\", line 99, in copy_table_from_yt_to_clickhouse\\n    settings)\\n  File \"transfer_manager/copy_yt_to_clickhouse/python/copy_table/preprocess_source_table.py\", line 183, in preprocess_source_table\\n    operation.wait()\\n  File \"yt/python/yt/wrapper/operation_commands.py\", line 752, in wait\\n    process_operation_unsuccesful_finish_state(self, self.get_error(state=state))\\n  File \"yt/python/yt/wrapper/operation_commands.py\", line 588, in process_operation_unsuccesful_finish_state\\n    raise error\\nYtOperationFailedError: Operation 9580751-5f74e786-3fe03e8-2942d544 failed\\n    Failed jobs limit exceeded\\n        User job failed\\n            Process terminated by signal 6\\n    User job failed\\n        Process terminated by signal 6\\n\\n***** Details:\\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed    \\n    origin          man1-7351-man-yt-transfer-manager-27570.gencfg-c.yandex.net on 2020-11-03T09:41:50.258169Z    \\n    stderrs         [{\\'host\\': \\'sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\\', \\'stderr\\': \\'uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan...message truncated...    \\n    url             http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details    \\n    state           failed    \\n    id              9580751-5f74e786-3fe03e8-2942d544\\nFailed jobs limit exceeded    \\n    code            215    \\n    origin          sas4-5483-controller-agent-hahn.sas.yp-c.yandex.net on 2020-11-03T09:41:37.419756Z (pid 2, tid 515b4a7187a0fe39, fid fffe1740f5733cf5)    \\n    max_failed_job_count 5\\nUser job failed    \\n    code            1205\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\nUser job failed    \\n    code            1205    \\n    stderr          uncaught exception:\\\\n    address -> 0x107804d40\\\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\\nProcess terminated by signal 6    \\n    code            10001    \\n    signal          6\\n'"
    },
    "execution_log": "2020-11-03 12:39:19,759 [INFO] -- copy_table.py -- creating yt client, cluster name = hahn.yt.yandex.net\n2020-11-03 12:39:20,213 [INFO] -- copy_table.py -- hello, robot-mkt-olap2!\n2020-11-03 12:39:20,462 [INFO] -- task_state.py -- tasks path: //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2\n2020-11-03 12:39:20,524 [INFO] -- create.py -- creating clickhouse client, cluster name = MDB:mstat-cubes-ssd\n2020-11-03 12:39:20,524 [INFO] -- command_discover_cluster.py -- discover cluster 'MDB:mstat-cubes-ssd': seed hosts = ['sas-2lpe9dyapqjgo5sw.db.yandex.net', 'sas-4mf6lg9tx63xvbxx.db.yandex.net', 'sas-6uaospyk6tfc194x.db.yandex.net', 'sas-6uoydvkvb4mxj170.db.yandex.net', 'sas-7swchytkkyudn4aj.db.yandex.net', 'sas-9o5f1k182otn52j4.db.yandex.net', 'sas-9z7nq93dz88f1pho.db.yandex.net', 'sas-azj2hs81egwhj69h.db.yandex.net', 'sas-cod524sauqza8bby.db.yandex.net', 'sas-gyriiyb7srqlf1pt.db.yandex.net', 'sas-h7ktahwgq544p3o4.db.yandex.net', 'sas-hpjgwxuctsnxqtfu.db.yandex.net', 'sas-ht2az1s8oguv935j.db.yandex.net', 'sas-itm372750t2ek38j.db.yandex.net', 'sas-j71aguqe2pbtovrk.db.yandex.net', 'sas-jwp1onzkyl41ixex.db.yandex.net', 'sas-l01n0dgam1rz5hl9.db.yandex.net', 'sas-m9s00o9xpzxtn6j9.db.yandex.net', 'sas-mru0evis4ry067gy.db.yandex.net', 'sas-mytr92dax16dcok2.db.yandex.net', 'sas-mz2nqotqabkzx6am.db.yandex.net', 'sas-p7ho4puhfhqmzd3b.db.yandex.net', 'sas-pjfd7kx8f1b8p2z8.db.yandex.net', 'sas-ptiwuyovbd07396g.db.yandex.net', 'sas-qe6ccu58diplp53r.db.yandex.net', 'sas-r5yuydxqpuba8ysc.db.yandex.net', 'sas-r7cpbgj6a900umgw.db.yandex.net', 'sas-rnrsxzwa4mnyk3fw.db.yandex.net', 'sas-vi5o8dxykpogitlo.db.yandex.net', 'sas-xkhz00getthvkxhz.db.yandex.net', 'vla-02m8f0dqoju644i0.db.yandex.net', 'vla-04x3o51vgfu96x8w.db.yandex.net', 'vla-13e5um2q2pkuq18i.db.yandex.net', 'vla-2w1jkz9f5xeg0os6.db.yandex.net', 'vla-6dkutjeme2g1z3rg.db.yandex.net', 'vla-74y256y8c4x3emnh.db.yandex.net', 'vla-9896isc40158oan5.db.yandex.net', 'vla-aemlr2ak76bob90f.db.yandex.net', 'vla-c6xs4kbdg7bhjrve.db.yandex.net', 'vla-cpt48s3th7q64hth.db.yandex.net', 'vla-dym6zpbh06y8jvg3.db.yandex.net', 'vla-fx55efz7jhl8350y.db.yandex.net', 'vla-g3prkd4nurv18rb1.db.yandex.net', 'vla-gi40aoy0s1yyeu4u.db.yandex.net', 'vla-hbpsokbznvxev614.db.yandex.net', 'vla-jr0gs65tkwqt8760.db.yandex.net', 'vla-mnwns773zj7p7f7d.db.yandex.net', 'vla-oaocqus17e5idopx.db.yandex.net', 'vla-q8eovca63ejngb8u.db.yandex.net', 'vla-rob5enh6riqhdros.db.yandex.net', 'vla-s54ies7elge462vo.db.yandex.net', 'vla-t44ck1a2z0yhd5pz.db.yandex.net', 'vla-u786pyaxsj95c8qx.db.yandex.net', 'vla-ubn3jnhd3beqmigz.db.yandex.net', 'vla-ukx1tmet3v8al0xw.db.yandex.net', 'vla-vhrapj2c0fsae9tg.db.yandex.net', 'vla-wu9y7ek7f0uw1h5n.db.yandex.net', 'vla-ygl8mgbtyain7wlh.db.yandex.net', 'vla-yo8crwmlmhgp4kp3.db.yandex.net', 'vla-yzh1ob4vn1fdmowe.db.yandex.net'], http port = 8443, credentials = (user = 'cubes_etl_user', password = 'w****************5')\n2020-11-03 12:39:21,107 [INFO] -- command_discover_cluster.py -- cluster 'MDB:mstat-cubes-ssd' discovered: <copy_yt_to_ch.cluster_client.cluster.Cluster object at 0x7f38a0357c10>\n2020-11-03 12:39:21,222 [INFO] -- create.py -- destination cluster 'MDB:mstat-cubes-ssd': 60 node(s), 30 shard(s)\n2020-11-03 12:39:21,222 [INFO] -- create.py -- checking availability of destination cluster...\n2020-11-03 12:39:21,879 [INFO] -- copy_table.py -- running brand new task\n2020-11-03 12:39:28,243 [INFO] -- discover_dest_table.py -- destination table exists: cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413 (`channel` Nullable(String), `control_crypta_visitors_numeric` Nullable(Decimal(15,8)), `control_delivered_aov_numeric` Nullable(Decimal(15,8)), `control_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_opc_numeric` Nullable(Decimal(15,8)), `control_gross_aov_numeric` Nullable(Decimal(15,8)), `control_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_opc_numeric` Nullable(Decimal(15,8)), `control_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `control_rel_ue_numeric` Nullable(Decimal(15,8)), `control_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_sessions_numeric` Nullable(Decimal(15,8)), `control_spu_numeric` Nullable(Decimal(15,8)), `control_ue_numeric` Nullable(Decimal(15,8)), `control_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_visitors_numeric` Nullable(Decimal(15,8)), `control_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `datetime` DateTime, `incremental_crypta_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_nmv_ue_exchange_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_sessions_mw95_numeric` Nullable(Decimal(15,8)), `incremental_spu_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `p_value_crypta_visitors_numeric` Nullable(Decimal(15,8)), `p_value_delivered_aov_numeric` Nullable(Decimal(15,8)), `p_value_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_opc_numeric` Nullable(Decimal(15,8)), `p_value_gross_aov_numeric` Nullable(Decimal(15,8)), `p_value_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_opc_numeric` Nullable(Decimal(15,8)), `p_value_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_sessions_numeric` Nullable(Decimal(15,8)), `p_value_spu_numeric` Nullable(Decimal(15,8)), `p_value_ue_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_visitors_numeric` Nullable(Decimal(15,8)), `p_value_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `report_month` Nullable(String), `sending_type` Nullable(String), `splice_correction_numeric` Nullable(Decimal(15,8)), `target_crypta_visitors` Nullable(Int64), `target_delivered_aov_numeric` Nullable(Decimal(15,8)), `target_delivered_crypta_customers` Nullable(Int64), `target_delivered_customers` Nullable(Int64), `target_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_multiorders` Nullable(Int64), `target_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_opc_numeric` Nullable(Decimal(15,8)), `target_gross_aov_numeric` Nullable(Decimal(15,8)), `target_gross_crypta_customers` Nullable(Int64), `target_gross_customers` Nullable(Int64), `target_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_multiorders` Nullable(Int64), `target_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_opc_numeric` Nullable(Decimal(15,8)), `target_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `target_rel_ue_numeric` Nullable(Decimal(15,8)), `target_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_scale_numeric` Nullable(Decimal(15,8)), `target_sessions` Nullable(Int64), `target_spu_numeric` Nullable(Decimal(15,8)), `target_ue_numeric` Nullable(Decimal(15,8)), `target_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_visitors` Nullable(Int64), `target_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `total_control_crm_segment` Nullable(Int64), `total_target_crm_segment` Nullable(Int64)) engine = ReplicatedMergeTree('/marketstat/cubes/ch/tables/{shard}/olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413', '{replica}') PARTITION BY toYYYYMM(datetime) ORDER BY tuple() SETTINGS index_granularity = 8192\n2020-11-03 12:39:28,555 [INFO] -- task_state.py -- create task yt directory: //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2/MDB:mstat-cubes-ssd.cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413\n2020-11-03 12:39:30,281 [INFO] -- prepare_rules_and_params.py -- prepare to copy clickhouse source table: infer schema, key columns, etc...\n2020-11-03 12:39:30,326 [INFO] -- prepare_rules_and_params.py -- inferred table parameters: schema = (`channel` Nullable(String), `control_crypta_visitors_numeric` Nullable(Decimal(15,8)), `control_delivered_aov_numeric` Nullable(Decimal(15,8)), `control_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_numeric` Nullable(Decimal(15,8)), `control_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_numeric` Nullable(Decimal(15,8)), `control_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `control_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_delivered_opc_numeric` Nullable(Decimal(15,8)), `control_gross_aov_numeric` Nullable(Decimal(15,8)), `control_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_numeric` Nullable(Decimal(15,8)), `control_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_numeric` Nullable(Decimal(15,8)), `control_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_numeric` Nullable(Decimal(15,8)), `control_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_gross_opc_numeric` Nullable(Decimal(15,8)), `control_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `control_rel_ue_numeric` Nullable(Decimal(15,8)), `control_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_sessions_numeric` Nullable(Decimal(15,8)), `control_spu_numeric` Nullable(Decimal(15,8)), `control_ue_numeric` Nullable(Decimal(15,8)), `control_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `control_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `control_visitors_numeric` Nullable(Decimal(15,8)), `control_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `datetime` DateTime, `incremental_crypta_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_delivered_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_aov_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_crypta_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_customers_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_gmv_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_multiorders_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_gross_opc_mw95_numeric` Nullable(Decimal(15,8)), `incremental_nmv_ue_exchange_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_rel_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_sessions_mw95_numeric` Nullable(Decimal(15,8)), `incremental_spu_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `incremental_ue_per_multiorder_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_mw95_numeric` Nullable(Decimal(15,8)), `incremental_visitors_per_incarnation_mw95_numeric` Nullable(Decimal(15,8)), `p_value_crypta_visitors_numeric` Nullable(Decimal(15,8)), `p_value_delivered_aov_numeric` Nullable(Decimal(15,8)), `p_value_delivered_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_numeric` Nullable(Decimal(15,8)), `p_value_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_numeric` Nullable(Decimal(15,8)), `p_value_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_delivered_opc_numeric` Nullable(Decimal(15,8)), `p_value_gross_aov_numeric` Nullable(Decimal(15,8)), `p_value_gross_crypta_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_numeric` Nullable(Decimal(15,8)), `p_value_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_numeric` Nullable(Decimal(15,8)), `p_value_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_numeric` Nullable(Decimal(15,8)), `p_value_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_gross_opc_numeric` Nullable(Decimal(15,8)), `p_value_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_numeric` Nullable(Decimal(15,8)), `p_value_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_sessions_numeric` Nullable(Decimal(15,8)), `p_value_spu_numeric` Nullable(Decimal(15,8)), `p_value_ue_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `p_value_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `p_value_visitors_numeric` Nullable(Decimal(15,8)), `p_value_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `report_month` Nullable(String), `sending_type` Nullable(String), `splice_correction_numeric` Nullable(Decimal(15,8)), `target_crypta_visitors` Nullable(Int64), `target_delivered_aov_numeric` Nullable(Decimal(15,8)), `target_delivered_crypta_customers` Nullable(Int64), `target_delivered_customers` Nullable(Int64), `target_delivered_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_numeric` Nullable(Decimal(15,8)), `target_delivered_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_multiorders` Nullable(Int64), `target_delivered_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_delivered_opc_numeric` Nullable(Decimal(15,8)), `target_gross_aov_numeric` Nullable(Decimal(15,8)), `target_gross_crypta_customers` Nullable(Int64), `target_gross_customers` Nullable(Int64), `target_gross_customers_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_numeric` Nullable(Decimal(15,8)), `target_gross_gmv_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_multiorders` Nullable(Int64), `target_gross_multiorders_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_gross_opc_numeric` Nullable(Decimal(15,8)), `target_nmv_ue_exchange_numeric` Nullable(Decimal(15,8)), `target_rel_ue_numeric` Nullable(Decimal(15,8)), `target_rel_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_scale_numeric` Nullable(Decimal(15,8)), `target_sessions` Nullable(Int64), `target_spu_numeric` Nullable(Decimal(15,8)), `target_ue_numeric` Nullable(Decimal(15,8)), `target_ue_per_incarnation_numeric` Nullable(Decimal(15,8)), `target_ue_per_multiorder_numeric` Nullable(Decimal(15,8)), `target_visitors` Nullable(Int64), `target_visitors_per_incarnation_numeric` Nullable(Decimal(15,8)), `total_control_crm_segment` Nullable(Int64), `total_target_crm_segment` Nullable(Int64)), engine parameters: primary key = tuple(), partition key = toYYYYMM(datetime)\n2020-11-03 12:39:57,572 [INFO] -- preprocess_source_table.py -- snaphot of source table //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10: revision = 566364455352106, row count = 4\n2020-11-03 12:39:57,572 [INFO] -- preprocess_source_table.py -- run preprocessing map from //home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10 to //tmp/copy_yt_to_clickhouse/tasks/robot-mkt-olap2/MDB:mstat-cubes-ssd.cubes.olap2tmp_cubes_clickhouse__fact_blue_crm_efficiency_global_aggr_v2_202010_1604396347413/shards\n2020-11-03 12:39:58,655\tINFO\tOperation started: http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details\n2020-11-03 12:39:58,815 ( 0 min)\toperation 9580751-5f74e786-3fe03e8-2942d544 starting\n2020-11-03 12:40:00,124 ( 0 min)\toperation 9580751-5f74e786-3fe03e8-2942d544 initializing\n2020-11-03 12:40:02,998 ( 0 min)\tUnrecognized spec: {'job_proxy_footprint': 200000000L, 'auto_merge': {'table_reader': {'window_size': 100000000L}}}\n2020-11-03 12:40:02,998 ( 0 min)\toperation 9580751-5f74e786-3fe03e8-2942d544 materializing\n2020-11-03 12:40:19,454 ( 0 min)\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=0     aborted=0     lost=0     total=1    \n2020-11-03 12:40:34,719 ( 0 min)\toperation 9580751-5f74e786-3fe03e8-2942d544: running=1     completed=0     pending=0     failed=1     aborted=0     lost=0     total=1    \n2020-11-03 12:41:11,461 ( 1 min)\toperation 9580751-5f74e786-3fe03e8-2942d544: running=1     completed=0     pending=0     failed=2     aborted=0     lost=0     total=1    \n2020-11-03 12:41:27,305 ( 1 min)\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=4     aborted=0     lost=0     total=1    \n2020-11-03 12:41:37,934 ( 1 min)\toperation 9580751-5f74e786-3fe03e8-2942d544: running=0     completed=0     pending=1     failed=5     aborted=0     lost=0     total=1    \n2020-11-03 12:41:43,067 ( 1 min)\toperation 9580751-5f74e786-3fe03e8-2942d544 failed\n2020-11-03 12:41:50,261\tWARNING\t***** Failed operation information:\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed\n    Failed jobs limit exceeded\n        User job failed\n            Process terminated by signal 6\n    User job failed\n        Process terminated by signal 6\n\n***** Details:\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed    \n    origin          man1-7351-man-yt-transfer-manager-27570.gencfg-c.yandex.net on 2020-11-03T09:41:50.258169Z    \n    stderrs         [{'host': 'sas4-4642-node-hahn.sas.yp-c.yandex.net:9012', 'stderr': 'uncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan...message truncated...    \n    url             http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details    \n    state           failed    \n    id              9580751-5f74e786-3fe03e8-2942d544\nFailed jobs limit exceeded    \n    code            215    \n    origin          sas4-5483-controller-agent-hahn.sas.yp-c.yandex.net on 2020-11-03T09:41:37.419756Z (pid 2, tid 515b4a7187a0fe39, fid fffe1740f5733cf5)    \n    max_failed_job_count 5\nUser job failed    \n    code            1205\nProcess terminated by signal 6    \n    code            10001    \n    signal          6\nUser job failed    \n    code            1205    \n    stderr          uncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\nProcess terminated by signal 6    \n    code            10001    \n    signal          6\n\n2020-11-03 12:41:50,261\tWARNING\tOne of the failed jobs:\nHost: sas4-4642-node-hahn.sas.yp-c.yandex.net:9012\nError:\nUser job failed\n    Process terminated by signal 6\n\n***** Details:\nUser job failed    \n    code            1205    \n    stderr          uncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\nProcess terminated by signal 6    \n    code            10001    \n    signal          6\n\nuncaught exception:\n    address -> 0x107804d40\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStringException) util/string/cast.cpp:679: cannot parse float(nan)\"\n    type -> yexception\n/bin/bash: line 1:    31 Aborted                 (core dumped) ./yt_to_ch_preprocessor_job --settings settings.json --translation-rules translation_rules.json --sharding-params sharding_params.json\n\n\nTraceback (most recent call last):\n  File \"<string>\", line 4, in <module>\n  File \"library/python/runtime/importer.pxi\", line 266, in __res.ResourceImporter.run_main\n    self.load_module(entry_point, fix_name='__main__')\n  File \"library/python/runtime/importer.pxi\", line 237, in __res.ResourceImporter.load_module\n    exec code in mod.__dict__\n  File \"__main__.py\", line 8, in <module>\n  File \"transfer_manager/copy_yt_to_clickhouse/python/tool/copy_table.py\", line 72, in copy_table\n    settings=settings,\n  File \"transfer_manager/copy_yt_to_clickhouse/python/copy_table/copy_table.py\", line 99, in copy_table_from_yt_to_clickhouse\n    settings)\n  File \"transfer_manager/copy_yt_to_clickhouse/python/copy_table/preprocess_source_table.py\", line 183, in preprocess_source_table\n    operation.wait()\n  File \"yt/python/yt/wrapper/operation_commands.py\", line 752, in wait\n    process_operation_unsuccesful_finish_state(self, self.get_error(state=state))\n  File \"yt/python/yt/wrapper/operation_commands.py\", line 588, in process_operation_unsuccesful_finish_state\n    raise error\nYtOperationFailedError: Operation 9580751-5f74e786-3fe03e8-2942d544 failed\n    Failed jobs limit exceeded\n        User job failed\n            Process terminated by signal 6\n    User job failed\n        Process terminated by signal 6\n\n***** Details:\nOperation 9580751-5f74e786-3fe03e8-2942d544 failed    \n    origin          man1-7351-man-yt-transfer-manager-27570.gencfg-c.yandex.net on 2020-11-03T09:41:50.258169Z    \n    stderrs         [{'host': 'sas4-4642-node-hahn.sas.yp-c.yandex.net:9012', 'stderr': 'uncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan...message truncated...    \n    url             http://hahn.yt.yandex.net/?page=operation&mode=detail&id=9580751-5f74e786-3fe03e8-2942d544&tab=details    \n    state           failed    \n    id              9580751-5f74e786-3fe03e8-2942d544\nFailed jobs limit exceeded    \n    code            215    \n    origin          sas4-5483-controller-agent-hahn.sas.yp-c.yandex.net on 2020-11-03T09:41:37.419756Z (pid 2, tid 515b4a7187a0fe39, fid fffe1740f5733cf5)    \n    max_failed_job_count 5\nUser job failed    \n    code            1205\nProcess terminated by signal 6    \n    code            10001    \n    signal          6\nUser job failed    \n    code            1205    \n    stderr          uncaught exception:\\n    address -> 0x107804d40\\n    what() -> \"transfer_manager/copy_yt_to_clickhouse/libs/row_translation/ch_column_decoder.cpp:23: cannot decode value of ClickHouse type Nullable(Decimal(15,8)) from Yt value \"nan\" (string_node) in column \"control_delivered_opc_numeric\": (TFromStri...message truncated...\nProcess terminated by signal 6    \n    code            10001    \n    signal          6\n",
    "finish_time": "2020-11-03T09:42:35.228182Z",
    "id": "762c2163-9810ffe0-24a9098a-766fc869",
    "mdb_cluster_address": {
        "cluster_id": "mdbmagdi50jo4ki15q2r"
    },
    "progress": {
        "operations": [
            {
                "cluster_name": "hahn",
                "id": "9580751-5f74e786-3fe03e8-2942d544",
                "type": "yt"
            }
        ],
        "transactions": []
    },
    "source_cluster": "hahn",
    "source_table": "//home/market/production/mstat/dwh/presentation/fact_blue_crm_efficiency_global_aggr_v2/2020-10",
    "start_time": "2020-11-03T09:39:17.650255Z",
    "state": "failed",
    "state_description": "An error has occured",
    "user": "robot-mkt-olap2"
}
