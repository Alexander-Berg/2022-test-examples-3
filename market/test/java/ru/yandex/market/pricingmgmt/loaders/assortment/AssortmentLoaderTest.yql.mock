[{"hashKey":"4f31300600bacd229d90555ccc0cad95","query":"USE hahn; \n        \n        PRAGMA DisableAnsiInForEmptyOrNullableItemsCollections;\n\n        $fullfilment_partners = (\n            SELECT\n                id\n            FROM `/home/market/production/mbi/dictionaries/partner_biz_snapshot/latest`  with inline\n            WHERE is_fullfilment = 1\n        );\n\n        $msku_with_fullfilment_supplier = (\n            SELECT\n                approved_market_sku_id as msku\n            FROM `/home/market/production/ir/ultra-controller/supplier_to_market_sku`  with inline\n            WHERE shop_id in $fullfilment_partners\n        );\n\n        $assortment = (\n            SELECT\n                model_id AS msku,\n                title,\n                category_id\n            FROM `/home/market/production/mbo/export/recent/models/sku`  with inline\n            WHERE model_id > 0 AND title != '' AND category_id > 0\n            AND model_id IN $msku_with_fullfilment_supplier\n        );\n\n        $fact_golden_matrix = (\n            SELECT DISTINCT\n                market_sku AS msku\n            FROM `/home/market/production/mstat/analyst/regular/cubes_vertica/fact_golden_matrix`  with inline\n            WHERE market_sku IS NOT NULL\n            AND market_sku IN $msku_with_fullfilment_supplier\n        );\n\n        $vendor_and_reserve_title_info = (\n            SELECT\n                o.approved_market_sku_id AS msku,\n                some(if(vendor_id > 0, vendor_id)) as vendor_id,\n                some(if(vendor_code is not null AND vendor_code != '', vendor_code)) as vendor_code,\n                some(if(title is not null AND title != '', title)) as reserve_title\n            FROM `/home/market/production/mbo/stat/mboc_offers_expanded_sku/latest`  with inline AS o\n            WHERE o.approved_market_sku_id > 0\n            AND o.supplier_id IN $fullfilment_partners\n            GROUP BY o.approved_market_sku_id\n        );\n\n        SELECT\n            CAST(a.msku as Int64)               AS msku,\n            coalesce(a.title, vi.reserve_title) AS title,\n            CAST(a.category_id as Int64)        AS category_id,\n            fgm.msku IS NOT NULL                AS core_fix_matrix,\n            CAST(vi.vendor_id as Int64)         AS vendor_id\n        FROM $assortment AS a\n        LEFT JOIN $fact_golden_matrix AS fgm ON fgm.msku = a.msku\n        LEFT JOIN $vendor_and_reserve_title_info AS vi ON vi.msku = a.msku;\n","data":"{\"data\":[ {\"Write\":[{\"Type\":[\"ListType\",[\"StructType\",[[\"msku\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"title\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"category_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"core_fix_matrix\",[\"DataType\",\"Bool\"]],[\"vendor_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]]]]],\"Data\":[[[\"111\"],[\"title1\"],[\"1\"],false,[\"1\"]],[[\"222\"],[\"title2\"],[\"2\"],true,[\"2\"]],[[\"444\"],[\"title4\"],[\"4\"],false,null]]}],\"Position\":{\"Column\":\"9\",\"Row\":\"49\",\"File\":\"<main>\"}}],\"errors\":[],\"id\":\"62ab87c4ae4e0fb58b7bec86\",\"issues\":[],\"status\":\"COMPLETED\",\"updatedAt\":\"2022-06-16T19:43:42.766Z\",\"version\":1000000}","type":"YQL_QUERY"},{"cacheKey":null,"base64Value":null,"type":"YT_DATA"}]