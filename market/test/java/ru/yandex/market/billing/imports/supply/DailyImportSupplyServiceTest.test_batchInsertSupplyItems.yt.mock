[{"hashKey":"07701449a9c609e0ed0fc0a90d7fef62","query":"USE hahn; select\n    si.request_id as request_id,\n    coalesce(si.supplier_id, si.return_supplier_id) as supplier_id,\n    si.article as article,\n    si.name as item_name,\n    si.fact_count as fact_count,\n    si.count as count,\n    mp.category_id as category_id,\n    mp.updated as updated,\n    si.surplus_count as surplus_count\nfrom `/home/market/production/mstat/dictionaries/fulfillment_request_item/1d/latest`  with inline as si\nleft join `/home/market/production/mstat/dictionaries/mbo/mboc_offers/latest`  with inline as mp\n on (si.article = mp.shop_sku and coalesce(si.supplier_id, si.return_supplier_id) = mp.supplier_id)\nwhere si.request_id in (\n    select\n      sr.id\n    from `/home/market/production/mstat/dictionaries/fulfillment_shop_request/1d/latest`  with inline as sr\n    where sr.status_name in ('Товары приняты', 'Товары оприходованы', 'Обработана')\n      and (sr.type_name in ('Пользовательский возврат', 'Поставка', 'Кроссдок поставка', 'Поставка для межскладского перемещения', 'Допоставка аномалий', 'Магистральный X-DOC')\n      or (type = 3 and external_operation_type = 9 and to_stock_type = 4))\n)\nand coalesce(si.supplier_id, si.return_supplier_id)!=465852 --1p записи лишние\n","data":"{\"data\":[ {\"Write\":[{\"Type\":[\"ListType\",[\"StructType\",[[\"request_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"supplier_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"article\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"item_name\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"fact_count\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"count\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"category_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"updated\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"surplus_count\",[\"OptionalType\",[\"DataType\",\"Int64\"]]]]]],\"Data\":[[[\"1\"],[\"123\"],[\"FEBESTMZD002\"],[\"lupa\"],[\"0\"],[\"0\"],[\"24341324\"],[\"2021-04-16 11:35:12.085026\"],[\"0\"]],[[\"4\"],[\"666\"],[\"MEME\"],[\"luckyboy\"],[\"0\"],[\"0\"],[\"9999\"],null,[\"0\"]],[[\"5\"],[\"777\"],[\"MOMO\"],[\"luckygirl\"],[\"0\"],[\"0\"],[\"1010\"],[\"2021-04-17 11:35:12.085026\"],[\"0\"]],[[\"2\"],[\"456\"],[\"18-308\"],[\"pupa\"],[\"0\"],[\"0\"],[\"543125432\"],[\"2021-04-09 05:21:14.031673\"],[\"0\"]],[[\"6\"],[\"888\"],[\"MUMU\"],[\"luckyman\"],[\"0\"],[\"0\"],[\"1212\"],[\"2021-04-18 11:35:12.085026\"],[\"0\"]],[[\"3\"],[\"123\"],[\"SOLID\"],[\"buhgalteria\"],[\"0\"],[\"0\"],null,null,[\"0\"]]]}],\"Position\":{\"Column\":\"11\",\"Row\":\"1\",\"File\":\"<main>\"}}],\"errors\":[],\"id\":\"620e698bd2706c4e794b0bff\",\"issues\":[{\"code\":1030,\"column\":0,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":11,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":177,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":54,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":10,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":5,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":171,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":72,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":14,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":14,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":18,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":18,\"severity\":\"S_WARNING\"},{\"code\":0,\"column\":72,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":15,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":15,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":19,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":19,\"severity\":\"S_WARNING\"}],\"message\":\"At function: Or\",\"row\":20,\"severity\":\"S_WARNING\"}],\"message\":\"At function: And\",\"row\":20,\"severity\":\"S_WARNING\"}],\"message\":\"At function: OrderedFilter, At function: Coalesce\",\"row\":17,\"severity\":\"S_WARNING\"}],\"message\":\"At function: PersistableRepr, At function: OrderedSqlProject\",\"row\":15,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":14,\"severity\":\"S_WARNING\"},{\"code\":0,\"column\":10,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":10,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":14,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":14,\"severity\":\"S_WARNING\"}],\"message\":\"At function: And\",\"row\":22,\"severity\":\"S_WARNING\"}],\"message\":\"At function: OrderedFilter, At function: Coalesce\",\"row\":11,\"severity\":\"S_WARNING\"}],\"message\":\"At function: RemovePrefixMembers, At function: Unordered, At function: PersistableRepr, At function: OrderedSqlProject\",\"row\":1,\"severity\":\"S_WARNING\"}],\"message\":\"Type annotation\",\"row\":0,\"severity\":\"S_WARNING\"}],\"status\":\"COMPLETED\",\"updatedAt\":\"2022-02-17T15:28:47.437Z\",\"version\":1000000}","type":"YQL_QUERY"},{"cacheKey":null,"base64Value":null,"type":"YT_DATA"}]