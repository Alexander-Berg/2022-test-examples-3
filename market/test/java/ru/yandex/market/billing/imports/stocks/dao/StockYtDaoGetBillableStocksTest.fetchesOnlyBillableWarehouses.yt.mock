[{"hashKey":"df8e8e6a6a335494e3f014924a08e4b0","query":"USE hahn; $suppliers =\nselect id\nfrom `/home/market/production/mstat/dictionaries/partner_types/2021-12-21`  with inline\nwhere type = 'SUPPLIER';\n\nselect\n    warehouse_id,\n    supplier_id,\n    shop_sku,\n    fit,\n    quarantine,\n    defect,\n    freezed,\n    expired,\n    lifetime\nfrom `/home/market/production/mstat/dwh/staging/stock_sku/2021-12-21`  with inline\nwhere supplier_id in $suppliers\n    and warehouse_id in (147, 171, 172, 500, 300, 301, 303, 302, 304)\n    and not (fit = 0 and defect = 0 and expired = 0);\n","data":"{\"data\":[ {\"Write\":[{\"Type\":[\"ListType\",[\"StructType\",[[\"warehouse_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"supplier_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"shop_sku\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"fit\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"quarantine\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"defect\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"freezed\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"expired\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"lifetime\",[\"OptionalType\",[\"DataType\",\"Int64\"]]]]]],\"Data\":[[[\"147\"],[\"101\"],[\"101-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"303\"],[\"101\"],[\"101-2\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"147\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"171\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"172\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"300\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"301\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"302\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"303\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"304\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]],[[\"500\"],[\"102\"],[\"102-1\"],[\"7\"],[\"1\"],[\"1\"],[\"3\"],[\"1\"],[\"30\"]]]}],\"Position\":{\"Column\":\"1\",\"Row\":\"6\",\"File\":\"<main>\"}}],\"errors\":[],\"id\":\"62cd606497c5b7d199675c4e\",\"issues\":[{\"code\":1030,\"column\":0,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":1,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":152,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":51,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":7,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":7,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":17,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":17,\"severity\":\"S_WARNING\"},{\"code\":0,\"column\":9,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":9,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":18,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":18,\"severity\":\"S_WARNING\"}],\"message\":\"At function: And, At function: And\",\"row\":19,\"severity\":\"S_WARNING\"}],\"message\":\"At function: OrderedFilter, At function: Coalesce\",\"row\":16,\"severity\":\"S_WARNING\"}],\"message\":\"At function: RemovePrefixMembers, At function: Unordered, At function: PersistableRepr, At function: OrderedSqlProject\",\"row\":6,\"severity\":\"S_WARNING\"}],\"message\":\"Type annotation\",\"row\":0,\"severity\":\"S_WARNING\"}],\"status\":\"COMPLETED\",\"updatedAt\":\"2022-07-12T11:52:46.690Z\",\"version\":1000000}","type":"YQL_QUERY"},{"cacheKey":null,"base64Value":null,"type":"YT_DATA"}]