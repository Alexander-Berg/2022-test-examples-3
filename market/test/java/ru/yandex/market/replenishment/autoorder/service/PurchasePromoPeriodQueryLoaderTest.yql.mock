[{"hashKey":"977011f1b02c177c0897b96e5c59b28a","query":"USE hahn; $exctract_date = ($dateTimeString) -> {\n    return DateTime::MakeDate(DateTime::Parse(\"%Y-%m-%d %H:%M:%S\")($dateTimeString));\n};\n\nselect\n    cast(msku as Int64) as msku,\n    cast($exctract_date(max_by(fromdate, recid)) as String) as promo_start,\n    cast($exctract_date(max_by(todate, recid)) as String) as promo_end\nfrom\n    `/home/market/production/mstat/dictionaries/axapta_supplier_prices/latest`  with inline\nwhere promo = 1\ngroup by msku having $exctract_date(max_by(todate, recid)) >= CurrentUtcDate()\n","data":"{\"data\":[ {\"Write\":[{\"Type\":[\"ListType\",[\"StructType\",[[\"msku\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"promo_start\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"promo_end\",[\"OptionalType\",[\"DataType\",\"String\"]]]]]],\"Data\":[[[\"123\"],[\"2019-07-05\"],[\"2099-08-30\"]]]}],\"Position\":{\"Column\":\"1\",\"Row\":\"5\",\"File\":\"<main>\"}}],\"errors\":[],\"id\":\"61c5e015054af0b3f8957a3f\",\"issues\":[{\"code\":0,\"column\":0,\"file\":\"<main>\",\"issues\":[{\"code\":4532,\"column\":10,\"file\":\"<main>\",\"issues\":[],\"message\":\"GROUP BY will aggregate by column `msku` instead of aggregating by SELECT expression with same alias\",\"row\":12,\"severity\":\"S_WARNING\"},{\"code\":4532,\"column\":5,\"file\":\"<main>\",\"issues\":[],\"message\":\"You should probably use alias in GROUP BY instead of using it here. Please consult documentation for more details\",\"row\":6,\"severity\":\"S_WARNING\"}],\"message\":\"Parse Sql\",\"row\":0,\"severity\":\"S_WARNING\"}],\"status\":\"COMPLETED\",\"updatedAt\":\"2021-12-24T14:59:16.237Z\",\"version\":1000000}"}]