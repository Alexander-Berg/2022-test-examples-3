[{"hashKey":"f2f5f2b9a06e65ce5ea534132a626398","query":"USE hahn; select 1","data":"{\"data\":[ {\"Write\":[{\"Type\":[\"ListType\",[\"StructType\",[[\"column0\",[\"DataType\",\"Int32\"]]]]],\"Data\":[[\"1\"]]}],\"Position\":{\"Column\":\"11\",\"Row\":\"1\",\"File\":\"<main>\"}}],\"errors\":[],\"id\":\"625836afbab793525864a96f\",\"issues\":[],\"status\":\"COMPLETED\",\"updatedAt\":\"2022-04-14T14:58:56.079Z\",\"version\":1000000}","type":"YQL_QUERY"},{"hashKey":"f2f5f2b9a06e65ce5ea534132a626398","query":"USE hahn; $suppliers = select id,name,type,supplier_type,real_supplier_id,business_id,is_fullfilment,is_crossdock,is_dropship\nfrom `/tmp/partner_biz_snapshot/latest`  with inline\nwhere type = 'SUPPLIER'\nand supplier_type in (1, 3, 0) and (supplier_type = 0 or is_fullfilment = 1 or is_crossdock = 1);\n\nselect id,name,type,supplier_type,real_supplier_id,business_id,is_fullfilment,is_crossdock,is_dropship\nfrom `/tmp/partner_biz_snapshot/latest`  with inline\nwhere id in (select business_id from $suppliers)\nunion all\nselect id,name,type,supplier_type,real_supplier_id,business_id,is_fullfilment,is_crossdock,is_dropship from $suppliers\norder by type, id;","data":"{\"data\":[ {\"Write\":[{\"Type\":[\"ListType\",[\"StructType\",[[\"business_id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"id\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"is_crossdock\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"is_dropship\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"is_fullfilment\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"name\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"real_supplier_id\",[\"OptionalType\",[\"DataType\",\"String\"]]],[\"supplier_type\",[\"OptionalType\",[\"DataType\",\"Int64\"]]],[\"type\",[\"OptionalType\",[\"DataType\",\"String\"]]]]]],\"Data\":[[null,[\"1\"],[\"0\"],[\"0\"],[\"0\"],[\"Business 1\"],null,null,[\"BUSINESS\"]],[null,[\"2\"],[\"0\"],[\"0\"],[\"0\"],[\"Business 2\"],null,null,[\"BUSINESS\"]],[[\"1\"],[\"100\"],[\"0\"],[\"0\"],[\"0\"],[\"Supplier 1\"],[\"000100\"],[\"0\"],[\"SUPPLIER\"]],[[\"0\"],[\"200\"],[\"0\"],[\"0\"],[\"1\"],[\"Supplier 2\"],[\"000200\"],[\"0\"],[\"SUPPLIER\"]],[[\"0\"],[\"300\"],[\"0\"],[\"0\"],[\"1\"],[\"Supplier 3\"],null,[\"3\"],[\"SUPPLIER\"]],[[\"0\"],[\"400\"],[\"1\"],[\"0\"],[\"0\"],[\"Supplier 4\"],null,[\"3\"],[\"SUPPLIER\"]],[[\"2\"],[\"500\"],[\"1\"],[\"0\"],[\"1\"],[\"Supplier 5\"],null,[\"3\"],[\"SUPPLIER\"]]]}],\"Position\":{\"Column\":\"1\",\"Row\":\"6\",\"File\":\"<main>\"}}],\"errors\":[],\"id\":\"625836b2bab793525864a973\",\"issues\":[{\"code\":1030,\"column\":0,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":1,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":122,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":7,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":14,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":24,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":122,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":95,\"file\":\"<main>\",\"issues\":[{\"code\":0,\"column\":5,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":5,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":4,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":4,\"severity\":\"S_WARNING\"}],\"message\":\"At function: And, At function: And\",\"row\":4,\"severity\":\"S_WARNING\"}],\"message\":\"At function: OrderedFilter, At function: Coalesce\",\"row\":2,\"severity\":\"S_WARNING\"}],\"message\":\"At function: PersistableRepr, At function: OrderedSqlProject\",\"row\":1,\"severity\":\"S_WARNING\"}],\"message\":\"At function: PersistableRepr, At function: OrderedSqlProject\",\"row\":8,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":8,\"severity\":\"S_WARNING\"},{\"code\":0,\"column\":7,\"file\":\"<main>\",\"issues\":[{\"code\":1108,\"column\":7,\"file\":\"<main>\",\"issues\":[],\"message\":\"IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;'\",\"row\":8,\"severity\":\"S_WARNING\"}],\"message\":\"At function: SqlIn\",\"row\":8,\"severity\":\"S_WARNING\"}],\"message\":\"At function: OrderedFilter, At function: Coalesce\",\"row\":7,\"severity\":\"S_WARNING\"}],\"message\":\"At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: Sort, At function: PersistableRepr, At function: OrderedSqlProject, At function: UnionAll, At function: PersistableRepr, At function: OrderedSqlProject\",\"row\":6,\"severity\":\"S_WARNING\"}],\"message\":\"Type annotation\",\"row\":0,\"severity\":\"S_WARNING\"}],\"status\":\"COMPLETED\",\"updatedAt\":\"2022-04-14T14:59:44.993Z\",\"version\":1000000}","type":"YQL_QUERY"},{"cacheKey":null,"base64Value":null,"type":"YT_DATA"}]