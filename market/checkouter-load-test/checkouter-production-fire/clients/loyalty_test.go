package clients

import (
	"encoding/json"
	"github.com/stretchr/testify/require"
	"testing"
)

const CoinsForCartJSON = "{\n\"applicableCoins\":[\n{\n\"id\":10060,\n\"title\":\"Скидкана100рублей\",\n\"subtitle\":\"навсезаказы\",\n\"coinType\":\"FIXED\",\n\"nominal\":100,\n\"description\":\"Скидку100рублейможноприменитьналюбойзаказ.\",\n\"promoKey\":\"_Xsny49ILVQa3WY9QhoLXQ\",\n\"endDate\":\"19-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[\n{\n\"categoryId\":1,\n\"msku\":\"123\",\n\"restrictionType\":\"CATEGORY\"\n},\n{\n\"categoryId\":2,\n\"msku\":\"456\",\n\"restrictionType\":\"CATEGORY\"\n}\n]\n},\n{\n\"id\":10061,\n\"title\":\"Скидкана500рублей\",\n\"subtitle\":\"Назаказот1000рублей\",\n\"coinType\":\"PERCENT\",\n\"nominal\":500,\n\"description\":\"Скидка500рублейдействуетнавсезаказыот1000рублей\",\n\"promoKey\":\"ZI9LqkWIn5xfT3rdNYYoQQ\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n},\n{\n\"id\":10066,\n\"title\":\"Скидкана100рублей\",\n\"subtitle\":\"навсезаказы\",\n\"coinType\":\"FREE_DELIVERY\",\n\"nominal\":null,\n\"description\":\"Скидку100рублейможноприменитьналюбойзаказ.\",\n\"promoKey\":\"-8ozbhmckNcmcNUOtlDUKg\",\n\"endDate\":\"19-09-201818:46:24\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"disabledCoins\":{\n\"LDI_RESTRICTION\":[\n{\n\"id\":100,\n\"title\":\"Скидкана500рублей\",\n\"subtitle\":\"Назаказот1000рублей\",\n\"coinType\":\"PERCENT\",\n\"nominal\":500,\n\"description\":\"Скидка500рублейдействуетнавсезаказыот1000рублей\",\n\"promoKey\":\"O7WF6gABSw4-vkxt0WWjWA\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n},\n{\n\"id\":101,\n\"title\":\"Скидкана100рублей\",\n\"subtitle\":\"навсезаказы\",\n\"coinType\":\"FREE_DELIVERY\",\n\"nominal\":null,\n\"description\":\"Скидку100рублейможноприменитьналюбойзаказ.\",\n\"promoKey\":\"AY2_tf7I2GRxTt5JzvUDQw\",\n\"endDate\":\"19-09-201818:46:24\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"DROP_RESTRICTION\":[\n{\n\"id\":105,\n\"title\":\"Скидканадоставку\",\n\"subtitle\":\"навсезаказы\",\n\"coinType\":\"FREE_DELIVERY\",\n\"nominal\":null,\n\"description\":\"Скидка500рублейдействуетнавсезаказыот1000рублей\",\n\"promoKey\":\"H6lL0nYA2PwyboycwoWEfg\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"DEVICE_RESTRICTION\":[\n{\n\"id\":106,\n\"title\":\"Скидка100рублей\",\n\"subtitle\":\"навсезаказысандроида\",\n\"coinType\":\"FIXED\",\n\"nominal\":100,\n\"description\":\"Скидка100рублейдействуетнавсезаказыcандроида\",\n\"promoKey\":\"H6lL0nYA2PwyboycwoWEfg\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"FILTER_RULE_RESTRICTION\":[\n{\n\"id\":107,\n\"title\":\"Скидка1000рублейнадрели\",\n\"subtitle\":\"фиксированнаяскидка\",\n\"coinType\":\"FIXED\",\n\"nominal\":1000,\n\"description\":\"Скидка1000рублейдействуетнавседрели\",\n\"promoKey\":\"PGPse-G2xJ5sMIOXAj_YzQ\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"SINGLE_FREE_DELIVERY_RESTRICTION\":[\n{\n\"id\":108,\n\"title\":\"Бесплатнаядоставка\",\n\"subtitle\":\"free\",\n\"coinType\":\"FREE_DELIVERY\",\n\"nominal\":1000,\n\"description\":\"толькооднамонетасбесплатнойдоставкойможетбытьприменена\",\n\"promoKey\":\"XjPfOa710uR2K6Pam2KxVg\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"SOME_NEW_RESTRICTION\":[\n{\n\"id\":103,\n\"title\":\"Скидкана500рублей\",\n\"subtitle\":\"Назаказот1000рублей\",\n\"coinType\":\"PERCENT\",\n\"nominal\":500,\n\"description\":\"Скидка500рублейдействуетнавсезаказыот1000рублей\",\n\"promoKey\":\"BewddI2eO7yXWgV_fNAvtg\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n],\n\"UNKNOWN\":[\n{\n\"id\":102,\n\"title\":\"Скидкана500рублей\",\n\"subtitle\":\"Назаказот1000рублей\",\n\"coinType\":\"PERCENT\",\n\"nominal\":500,\n\"description\":\"Скидка500рублейдействуетнавсезаказыот1000рублей\",\n\"promoKey\":\"H6lL0nYA2PwyboycwoWEfg\",\n\"endDate\":\"29-09-201818:43:20\",\n\"image\":\"https://avatars.mdst.yandex.net/get-smart_shopping/1823/2080eff0-2a8e-4679-926c-032dfb3b29b8/\",\n\"backgroundColor\":null,\n\"coinRestrictions\":[]\n}\n]\n}\n}"

func TestCoinsForCart(t *testing.T) {
	result := &СoinsForCart{}

	err := json.Unmarshal([]byte(CoinsForCartJSON), result)
	if err != nil {
		panic(err)
	}

	require.Equal(t, 10060, result.ApplicableCoins[0].ID)
	require.Equal(t, 101, result.DisabledCoins["LDI_RESTRICTION"][1].ID)
}
