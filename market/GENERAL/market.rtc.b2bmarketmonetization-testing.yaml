# Generated by tsum-pipeline

juggler:
  default:
    host: b2bmarketmonetization-testing
    namespace: market.common
    refresh_time: 60
    ttl: 900
    aggregator: timed_more_than_limit_is_problem
    aggregator_kwargs:
      limits:
        - crit: 0%
          day_end: 7
          day_start: 1
          time_end: 20
          time_start: 8
          warn: '0'
        - crit: 30%
          day_end: 7
          day_start: 1
          time_end: 7
          time_start: 21
          warn: '0'
      nodata_mode: force_crit
    check_options: { }
    flaps:
      stable_time: 600
      critical_time: 3000
      boost_time: 0
    tags:
      - market_testing
      - market_rtc
      - marketadvmonetization
      - market
      - testing
      - market_adv_monetization_testing
      - market
      - _market_
    children:
      - 'DEPLOY%market-adv@stage=testing_market_b2bmarketmonetization;deploy_unit=b2bmarketmonetization'

  checks:
    - service: ping
    - service: disk_free_space
      nodata_mode: force_ok
    - service: logrotate
      nodata_mode: force_ok
    - service: push-client-status
      nodata_mode: force_ok
    - service: monitoring
    - service: fresh-hprof-files
      nodata_mode: force_ok
    - service: logrotate-app
      nodata_mode: force_ok
    - active: http
      active_kwargs:
        ok_codes:
          - 200
        path: /tms/jobs/status
        regexp: ^0;.*
        warn_codes: [ ]
        always_show_body: true
        timeout: 180
      aggregator_kwargs:
        limits:
          - crit: 0%
            day_end: 7
            day_start: 1
            time_end: 20
            time_start: 8
            warn: '0'
          - crit: 30%
            day_end: 7
            day_start: 1
            time_end: 7
            time_start: 21
            warn: '0'
        nodata_mode: force_crit
      service: tms_job_status
    - active: http
      active_kwargs:
        ok_codes:
          - 200
        path: /juggler/file/offer/tasks/status
        warn_codes:
          - 400
        always_show_body: true
        timeout: 180
      aggregator_kwargs:
        limits:
          - crit: 0%
            day_end: 7
            day_start: 1
            time_end: 20
            time_start: 8
            warn: '0'
          - crit: 30%
            day_end: 7
            day_start: 1
            time_end: 7
            time_start: 21
            warn: '0'
        nodata_mode: force_crit
      service: active_offer_file_tasks_status
    - active: http
      active_kwargs:
        ok_codes:
          - 200
        path: /juggler/program/status
        regexp: ^0;.*
        warn_codes: [ ]
        always_show_body: true
        timeout: 180
      aggregator_kwargs:
        limits:
          - crit: 0%
            day_end: 7
            day_start: 1
            time_end: 20
            time_start: 8
            warn: '0'
          - crit: 30%
            day_end: 7
            day_start: 1
            time_end: 7
            time_start: 21
            warn: '0'
        nodata_mode: force_crit
      service: program_tasks_status
    - active: http
      active_kwargs:
        ok_codes:
          - 200
        path: /juggler/program/status/enqueued
        regexp: ^0;.*
        warn_codes: [ ]
        always_show_body: true
        timeout: 180
      aggregator_kwargs:
        limits:
          - crit: 0%
            day_end: 7
            day_start: 1
            time_end: 20
            time_start: 8
            warn: '0'
          - crit: 30%
            day_end: 7
            day_start: 1
            time_end: 7
            time_start: 21
            warn: '0'
        nodata_mode: force_crit
      service: program_tasks_enqueued_status
