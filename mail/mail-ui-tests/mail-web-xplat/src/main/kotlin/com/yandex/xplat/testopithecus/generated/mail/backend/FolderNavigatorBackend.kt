// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM mail/backend/folder-navigator-backend.ts >>>

package com.yandex.xplat.testopithecus

import com.yandex.xplat.common.YSArray
import com.yandex.xplat.common.filter
import com.yandex.xplat.common.map

public open class FolderNavigatorBackend(private var mailListDisplayBackend: MessageListDisplayBackend, private var clientsHandler: MailboxClientHandler): FolderNavigator {
    open override fun getFoldersList(): YSArray<FolderName> {
        return this.clientsHandler.getCurrentClient().getFolderList().map( {
            meta ->
            meta.name!!
        })
    }

    open override fun goToFolder(folderDisplayName: String, parentFolders: YSArray<String>): Unit {
        val folderBackendName = toBackendFolderName(folderDisplayName, parentFolders)
        val folder = this.clientsHandler.getCurrentClient().getFolderList().filter( {
            f ->
            f.name == folderBackendName
        })[0]
        this.mailListDisplayBackend.setCurrentFolderId(folder.fid)
    }

    open fun getCurrentContainer(): FolderName {
        val currentFolderName = this.clientsHandler.getCurrentClient().getFolderList().filter( {
            meta ->
            meta.fid == this.mailListDisplayBackend.getCurrentFolderId()
        })[0].name!!
        return currentFolderName
    }

    open override fun closeFolderList(): Unit {
    }

    open override fun openFolderList(): Unit {
    }

    open override fun isInTabsMode(): Boolean {
        val currentSettings = this.clientsHandler.getCurrentClient().getSettings()
        return currentSettings.payload!!.userParameters.showFoldersTabs
    }

}

