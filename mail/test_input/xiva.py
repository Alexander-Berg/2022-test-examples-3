header = {'server': 'xiva02h.mail.yandex.net',
          'path': '/var/log/yxiva/typed.log'}

data = """tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=add	client=bar	connection=oLPaJZuUR0U1	filter=	group=subscriptions	service=mail	session=d12769b9-b010-4342-a063-079d75145bfb	uid=178684291
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=send	client=daria	event=unsupported	filter=	group=notifications	local_id=15	mid=	send_context=oLPqJZuUUSw1	service=mail	session=neo2-1460031704261-82479984	subscription_id=5879cc8e9655b7a44a669397ad536dcae8e4e5ff	transit_id=oLPvVVtTruQ1	uid=98692010
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=add	client=daria	connection=oLPhJZuURiE1	filter=	group=subscriptions	service=mail	session=neo2-1460017272277-86373607	uid=1130000000138102
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	client=yabrowser	filter=	group=channels	service=mail	session=32a4467f1c6d8b73	status=subscribed	subscription_id=8555fa8664dd9952417c7334336ed06557641295	uid=62439650
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	client=daria	filter=	group=channels	service=mail	session=neo2-1460017272277-86373607	status=subscribed	subscription_id=a9d8159409749c2f4944179f2e59659c8e4373a1	uid=1130000000138102
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	client=bar	filter=	group=channels	service=mail	session=d12769b9-b010-4342-a063-079d75145bfb	status=subscribed	subscription_id=575912abb609c27a9f27a33462e3285d1595dbcb	uid=178684291
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=send	client=bar	event=unsupported	filter=	group=notifications	local_id=9187	mid=	send_context=oLP3KZuUSSw1	service=mail	session=14acc300-9c56-4452-9e6d-7fbeda06847f	subscription_id=2407ebd05b7831e205d7fc003701b694a43051ff	transit_id=oLPAo0eXqCg1	uid=69136113
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=send	client=daria	event=insert	filter=	group=notifications	local_id=4024	mid=158470411888135497	send_context=oLP8KZuUUeA1	service=mail	session=neo2-1460025567426-52111461	subscription_id=629d0abc8958cfe1e9f2b8285c97a34229709858	transit_id=oLPYo0eXq4Y1	uid=69205007
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=send	client=morda	event=insert	filter=	group=notifications	local_id=435	mid=158470411888102472	send_context=oLPEKZuUSSw1	service=mail	session=22879-15525-1460014066-17445	subscription_id=5f2244e1edeacb695083b8faf21a6e137c6c024a	transit_id=oLPamu3F9Os1	uid=81629270
tskv	tskv_format=xivaserver-log	timestamp=2016-04-07 15:21:50	timezone=+0300	action=del	client=mordaInbox	connection=mLPZAZuUSeA1	filter=	group=subscriptions	service=mail	session=41e86c2e53df2e3193a8c63482c02838	uid=121655408
"""

expected = {'xiva_notifications_uid_ts': [['857219f8f9896e352e6d98120000822c_18446742613677841196',
                                           {'cf:action': 'send',
                                            'cf:client': 'daria',
                                            'cf:event': 'unsupported',
                                            'cf:filter': '',
                                            'cf:group': 'notifications',
                                            'cf:local_id': '15',
                                            'cf:mid': '',
                                            'cf:send_context': 'oLPqJZuUUSw1',
                                            'cf:service': 'mail',
                                            'cf:session': 'neo2-1460031704261-82479984',
                                            'cf:subscription_id': '5879cc8e9655b7a44a669397ad536dcae8e4e5ff',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:transit_id': 'oLPvVVtTruQ1',
                                            'cf:uid': '98692010'}],
                                          ['44c97061f15af66645bcd741b04f2c08_18446742613677841196',
                                           {'cf:action': 'send',
                                            'cf:client': 'bar',
                                            'cf:event': 'unsupported',
                                            'cf:filter': '',
                                            'cf:group': 'notifications',
                                            'cf:local_id': '9187',
                                            'cf:mid': '',
                                            'cf:send_context': 'oLP3KZuUSSw1',
                                            'cf:service': 'mail',
                                            'cf:session': '14acc300-9c56-4452-9e6d-7fbeda06847f',
                                            'cf:subscription_id': '2407ebd05b7831e205d7fc003701b694a43051ff',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:transit_id': 'oLPAo0eXqCg1',
                                            'cf:uid': '69136113'}],
                                          ['2c7e6a25f502e3e86b0d12f088ec2b79_18446742613677841196',
                                           {'cf:action': 'send',
                                            'cf:client': 'daria',
                                            'cf:event': 'insert',
                                            'cf:filter': '',
                                            'cf:group': 'notifications',
                                            'cf:local_id': '4024',
                                            'cf:mid': '158470411888135497',
                                            'cf:send_context': 'oLP8KZuUUeA1',
                                            'cf:service': 'mail',
                                            'cf:session': 'neo2-1460025567426-52111461',
                                            'cf:subscription_id': '629d0abc8958cfe1e9f2b8285c97a34229709858',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:transit_id': 'oLPYo0eXq4Y1',
                                            'cf:uid': '69205007'}],
                                          ['c62a4456e3a64f49e5d78e203d914244_18446742613677841196',
                                           {'cf:action': 'send',
                                            'cf:client': 'morda',
                                            'cf:event': 'insert',
                                            'cf:filter': '',
                                            'cf:group': 'notifications',
                                            'cf:local_id': '435',
                                            'cf:mid': '158470411888102472',
                                            'cf:send_context': 'oLPEKZuUSSw1',
                                            'cf:service': 'mail',
                                            'cf:session': '22879-15525-1460014066-17445',
                                            'cf:subscription_id': '5f2244e1edeacb695083b8faf21a6e137c6c024a',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:transit_id': 'oLPamu3F9Os1',
                                            'cf:uid': '81629270'}]],
            'xiva_subscriptions_uid_ts': [['afb37095b1ea995e4a33217133248161_18446742613677841196',
                                           {'cf:action': 'add',
                                            'cf:client': 'bar',
                                            'cf:connection': 'oLPaJZuUR0U1',
                                            'cf:filter': '',
                                            'cf:group': 'subscriptions',
                                            'cf:service': 'mail',
                                            'cf:session': 'd12769b9-b010-4342-a063-079d75145bfb',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:uid': '178684291'}],
                                          ['99acb020338a1fe3c46634f7a9a869cc_18446742613677841196',
                                           {'cf:action': 'add',
                                            'cf:client': 'daria',
                                            'cf:connection': 'oLPhJZuURiE1',
                                            'cf:filter': '',
                                            'cf:group': 'subscriptions',
                                            'cf:service': 'mail',
                                            'cf:session': 'neo2-1460017272277-86373607',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:uid': '1130000000138102'}],
                                          ['b76e72f53abfc4f2daf5b9b5a6c8a426_18446742613677841196',
                                           {'cf:action': 'del',
                                            'cf:client': 'mordaInbox',
                                            'cf:connection': 'mLPZAZuUSeA1',
                                            'cf:filter': '',
                                            'cf:group': 'subscriptions',
                                            'cf:service': 'mail',
                                            'cf:session': '41e86c2e53df2e3193a8c63482c02838',
                                            'cf:timestamp': '2016-04-07 15:21:50',
                                            'cf:timezone': '+0300',
                                            'cf:uid': '121655408'}]]}
